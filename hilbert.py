# -*- coding: utf-8 -*-
"""
Created on Sat Apr 26 14:59:26 2025

@author: User
"""

import math
import time
import numpy as np
import matplotlib.pyplot as plt
import pywt
from PyEMD import EMD
from numpy.fft import fft, fftfreq
from scipy.signal import butter, sosfiltfilt, hilbert
from vmdpy import VMD
import pandas as pd
from scipy.signal import find_peaks



plt.close("all")

samplingFreq = 110.86  
samplingFreq = 192.3   # FIR design sampling frequency (Hz) for beam test
#samplingFreq = 200
processRate = 200.0
samplingFreq = processRate
fft_cutoff_freq = 100.0

N = 51
FC1 = 1.0
FC2 = 6.0

firCoeffs = [0.0] * N
firBuffer = [0.0] * N
sampleIndex = 0

accelerationSamples = [
#Beam Test
#0.35, 0.39, 0.3, 0.27, 0.24, 0.2, 0.08, 0.04, 0.03, -0.03, -0.03, -0.07, -0.08, -0.11, -0.08, -0.15, -0.18, -0.14, -0.11, -0.05, -0.04, 0, 0.04, -0.04, -0.03, -0.03, -0.04, -0.08, -0.08, -0.03, -0.04, -0.14, -0.14, -0.13, -0.24, -0.24, -0.2, -0.07, 0, 0.04, 0.01, 0.09, 0.12, 0.09, 0.18, 0.24, 0.22, 0.27, 0.37, 0.35, 0.38, 0.33, 0.24, 0.22, 0.15, 0.03, -0.11, -0.09, -0.15, -0.23, -0.39, -0.37, -0.41, -0.42, -0.39, -0.42, -0.32, -0.34, -0.36, -0.26, -0.11, -0.16, -0.07, -0.03, 0.1, 0.28, 0.43, 0.4, 0.43, 0.57, 0.67, 0.54, 0.47, 0.4, 0.32, 0.34, 0.19, 0.07, -0.04, -0.11, -0.2, -0.33, -0.33, -0.36, -0.4, -0.44, -0.44, -0.47, -0.37, -0.37, -0.32, -0.19, -0.23, -0.1, 0.01, 0.16, 0.18, 0.14, 0.23, 0.4, 0.4, 0.31, 0.26, 0.29, 0.27, 0.27, 0.2, 0.12, 0.1, 0.04, -0.04, -0.05, -0.11, -0.12, -0.11, -0.18, -0.12, -0.21, -0.13, -0.19, -0.06, -0.09, -0.03, -0.07, -0.07, -0.03, -0.07, -0.04, -0.02, -0.11, -0.1, -0.1, -0.08, -0.09, -0.06, -0.11, -0.1, -0.11, -0.11, -0.02, 0.04, 0.1, 0.14, 0.07, 0.09, 0.12, 0.34, 0.36, 0.31, 0.24, 0.29, 0.38, 0.24, 0.24, 0.2, 0.1, 0, -0.03, -0.31, -0.27, -0.31, -0.35, -0.35, -0.39, -0.35, -0.45, -0.37, -0.4, -0.27, -0.23, -0.14, 0, -0.06, 0.11, 0.17, 0.23, 0.31, 0.36, 0.42, 0.49, 0.48, 0.43, 0.5, 0.51, 0.4, 0.17, 0.1, 0.11, 0, -0.06, -0.12, -0.16, -0.25, -0.41, -0.41, -0.4, -0.42, -0.3, -0.33, -0.39, -0.26, -0.18, -0.2, -0.18, 0.04, 0.12, 0.07, 0.2, 0.24, 0.29, 0.35, 0.4, 0.17, 0.24, 0.24, 0.2, 0.18, 0.16, 0.12, 0.08, 0.06, -0.05, -0.03, -0.04, -0.11, -0.04, -0.12, -0.16, -0.11, -0.19, -0.14, -0.19, -0.12, -0.08, -0.08, -0.13, 0.03, -0.02, 0.02, -0.11, 0, -0.09, -0.08, -0.09, -0.11, 0, -0.05, 0, -0.03, 0.08, 0.03, 0.1, 0.08, 0.04, 0.1, 0.16, 0.2, 0.22, 0.24, 0.36, 0.19, 0.17, 0.19, 0.16, 0.12, 0.11, 0.06, -0.04, -0.13, -0.19, -0.24, -0.31, -0.37, -0.39, -0.42, -0.39, -0.42, -0.35, -0.28, -0.35, -0.11, -0.16, -0.16, -0.06, 0.11, 0.17, 0.36, 0.31, 0.37, 0.43, 0.41, 0.4, 0.39, 0.41, 0.34, 0.28, 0.2, 0.12, -0.04, -0.09, -0.07, -0.24, -0.27, -0.34, -0.33, -0.28, -0.49, -0.41, -0.28, -0.3, -0.32, -0.27, -0.2, -0.09, -0.05, 0.03, 0.1, 0.12, 0.2, 0.11, 0.29, 0.24, 0.29, 0.23, 0.27, 0.23, 0.16, 0.2, 0.13, 0.07, 0.1, 0.05, -0.07, 0, -0.06, 0, -0.11, -0.15, -0.06, -0.06, -0.07, -0.2, -0.11, -0.2, -0.07, -0.11, -0.07, -0.17, -0.02, -0.04, -0.11, -0.07, -0.09, -0.06, -0.14, -0.08, -0.1, -0.03, -0.06, 0.06, 0.08, 0.11, 0.12, 0.09, 0.24, 0.2, 0.16, 0.17, 0.15, 0.26, 0.27, 0.22, 0.2, 0, 0.07, 0.03, -0.11, -0.09, -0.13, -0.17, -0.18, -0.24, -0.39, -0.31, -0.24, -0.41, -0.31, -0.28, -0.28, -0.17, -0.2, -0.11, -0.03, -0.03, 0.1, 0.19, 0.24, 0.22, 0.37, 0.36, 0.43, 0.45, 0.44, 0.36, 0.35, 0.34, 0.37, 0.29, 0.09, 0.04, -0.11, -0.16, -0.23, -0.27, -0.3, -0.3, -0.31, -0.34, -0.37, -0.33, -0.3, -0.23, -0.19, -0.19, -0.08, -0.06, -0.03, 0.08, 0.1, 0.21, 0.22, 0.28, 0.28, 0.24, 0.37, 0.26, 0.22, 0.23, 0.18, 0.12, 0.12, 0.02, -0.03, 0.04, 0.01, -0.07, -0.11, -0.03, -0.07, -0.12, -0.1, -0.18, -0.07, -0.15, -0.19, -0.14, -0.1, -0.16, -0.21, -0.11, -0.11, -0.09, -0.07, 0.03, -0.02, 0, 0.03, -0.05, -0.02, 0.1, 0.02, 0.14, 0.19, 0, 0.16, 0.14, 0.14, 0.24, 0.23, 0.17, 0.29, 0.18, 0.24, 0.08, 0.07, 0.05, 0, 0, -0.14, -0.12, -0.16, -0.27, -0.28, -0.23, -0.37, -0.35, -0.31, -0.29, -0.15, -0.2, -0.18, -0.08, -0.03, 0.02, 0.07, 0.04, 0.15, 0.2, 0.3, 0.21, 0.38, 0.42, 0.45, 0.35, 0.46, 0.3, 0.3, 0.13, 0.14, 0.07, -0.08, -0.15, -0.26, -0.23, -0.33, -0.28, -0.31, -0.33, -0.35, -0.35, -0.3, -0.32, -0.31, -0.25, -0.15, -0.17, -0.12, -0.07, 0.03, 0.09, 0.19, 0.09, 0.28, 0.2, 0.35, 0.28, 0.19, 0.2, 0.32, 0.2, 0.24, 0.03, 0.04, 0.02, -0.03, -0.11, -0.03, -0.06, -0.04, -0.03, -0.16, -0.09, -0.09, -0.14, -0.08, -0.07, -0.18, -0.11, -0.07, -0.11, -0.07, -0.16, -0.08, -0.08, -0.09, -0.11, 0.08, 0.07, 0.02, 0, 0.07, 0.06, 0.08, 0.12, 0.15, 0.2, 0.16, 0.18, 0.28, 0.2, 0.19, 0.15, 0.15, 0.15, 0.08, 0.12, -0.04, -0.04, -0.09, -0.12, -0.16, -0.18, -0.29, -0.37, -0.42, -0.35, -0.3, -0.3, -0.27, -0.21, -0.19, -0.18, -0.09, -0.03, 0.05, 0.05, 0.19, 0.26, 0.27, 0.32, 0.3, 0.36, 0.32, 0.38, 0.35, 0.28, 0.16, 0.28, 0.13, -0.01, -0.03, -0.1, -0.11, -0.18, -0.19, -0.26, -0.42, -0.33, -0.38, -0.35, -0.32, -0.27, -0.24, -0.24, -0.19, -0.09, -0.04, -0.03, 0.04, 0.15, 0.12, 0.13, 0.2, 0.21, 0.22, 0.13, 0.31, 0.21, 0.22, 0.19, 0.23, 0.01, 0.16, 0.07, 0.05, 0.04, -0.02, -0.02, -0.06, -0.19, -0.16, -0.11, -0.13, -0.09, -0.1, -0.18, -0.16, -0.12, -0.12, -0.15, -0.11, -0.13, -0.1, 0, -0.16, -0.07, -0.11, -0.05, 0.04, 0.04, -0.02, 0.13, 0.16, 0.12, 0.27, 0.16, 0.14, 0.19, 0.24, 0.2, 0.24, 0.17, 0.06, 0.05, 0.12, 0.1, 0, -0.03, -0.11, -0.11, -0.18, -0.2, -0.31, -0.28, -0.22, -0.27, -0.37, -0.29, -0.24, -0.21, -0.16, -0.11, -0.15, -0.08, 0.04, -0.03, 0.08, 0.26, 0.23, 0.35, 0.34, 0.24, 0.42, 0.24, 0.4, 0.36, 0.21, 0.2, 0.14, 0.08, 0.06, 0.03, -0.18, -0.17, -0.17, -0.23, -0.3, -0.28, -0.29, -0.31, -0.31, -0.35, -0.3, -0.27, -0.19, -0.14
#0.01, 0.02, 0.12, 0.12, 0.12, 0.12, 0.2, 0.17, 0.22, 0.2, 0.2, 0.15, 0.13, 0.12, 0.05, 0.08, 0.04, 0, -0.06, -0.07, -0.11, -0.03, -0.15, -0.14, -0.21, -0.18, -0.18, -0.14, -0.12, -0.18, -0.21, -0.17, -0.17, -0.1, -0.08, 0.01, 0.04, 0.06, 0.07, 0, 0.13, 0.14, 0.16, 0.16, 0.18, 0.2, 0.18, 0.2, 0.06, 0.22, 0.15, 0.1, -0.03, 0.06, -0.02, 0.08, -0.05, -0.04, -0.19, -0.15, -0.18, -0.28, -0.13, -0.22, -0.24, -0.23, -0.21, -0.2, -0.16, -0.15, -0.05, -0.03, 0, 0, 0.06, 0.13, 0.17, 0.2, 0.24, 0.24, 0.19, 0.19, 0.16, 0.24, 0.12, 0.04, 0.1, 0.13, 0.1, -0.07, -0.07, -0.05, -0.06, -0.15, -0.15, -0.21, -0.23, -0.2, -0.2, -0.21, -0.18, -0.15, -0.15, -0.13, -0.09, -0.11, -0.07, -0.03, 0, 0.04, 0.1, 0.08, 0.17, 0.22, 0.11, 0.22, 0.16, 0.18, 0.18, 0.03, 0.18, 0.13, 0.12, 0.1, 0.1, 0.04, -0.07, -0.03, -0.11, -0.09, -0.04, -0.1, -0.16, -0.2, -0.2, -0.16, -0.17, -0.19, -0.17, -0.16, -0.14, -0.13, -0.08, 0.01, -0.03, -0.04, -0.07, 0.14, 0.08, 0.12, 0.16, 0.16, 0.18, 0.24, 0.16, 0.16, 0.12, 0.2, 0.19, 0.14, 0.06, 0.06, 0.04, -0.03, -0.07, -0.08, -0.11, -0.16, -0.18, -0.19, -0.26, -0.23, -0.15, -0.26, -0.13, -0.28, -0.12, -0.13, -0.15, -0.03, -0.03, 0.13, 0.16, 0.15, 0.28, 0.15, 0.22, 0.26, 0.33, 0.24, 0.2, 0.19, 0.17, 0.12, 0.08, 0.09, 0.04, 0.04, -0.02, -0.08, -0.1, -0.11, -0.15, -0.16, -0.18, -0.19, -0.22, -0.17, -0.16, -0.15, -0.11, -0.24, -0.12, -0.14, -0.03, -0.06, 0.12, 0, 0.02, 0.15, 0.13, 0.19, 0.16, 0.12, 0.12, 0.16, 0.18, 0.2, 0.19, 0.05, 0.06, 0.15, 0.04, 0.08, 0.03, 0.04, 0.02, 0.04, -0.11, -0.09, -0.21, -0.17, -0.04, -0.16, -0.15, -0.23, -0.2, -0.19, -0.14, -0.13, -0.05, 0, -0.03, 0.01, 0.08, 0.08, 0.11, 0.14, 0.17, 0.12, 0.24, 0.19, 0.22, 0.26, 0.19, 0.16, 0.21, 0.09, 0.07, 0.01, -0.11, -0.07, -0.08, -0.09, -0.11, -0.09, -0.19, -0.23, -0.16, -0.17, -0.28, -0.19, -0.25, -0.28, -0.24, -0.28, -0.27, -0.26, -0.2, -0.19, -0.28, -0.22, -0.36, -0.34, -0.3, -0.35, -0.34, -0.27, -0.28, -0.15, -0.17, 0.24, 0.38, 0.81, 1.37, 1.55, 2, 2.01, 1.9, 1.26, 0.89, 0.41, -0.02, -0.28, -0.6, -0.7, -0.66, -0.67, -0.69, -0.56, -0.7, -0.66, -0.77, -0.74, -0.85, -0.66, -0.44, -0.43, -0.36, -0.35, -0.26, -0.21, -0.12, 0.1, 0.36, 1.22, 1.14, 1.89, 2.05, 2.31, 2, 1.39, 1, 0.33, 0.21, -0.31, -0.37, -0.44, -0.49, -0.62, -0.77, -0.74, -0.85, -0.78, -0.86, -0.79, -0.7, -0.65, -0.6, -0.66, -0.58, -0.62, -0.35, -0.3, 0.04, 0.21, 0.7, 1.19, 1.57, 1.96, 2.17, 2.03, 1.85, 1.19, 0.89, 0.36, 0.07, -0.33, -0.4, -0.4, -0.58, -0.67, -0.57, -0.65, -0.66, -0.77, -0.85, -0.83, -0.9, -0.82, -0.74, -0.62, -0.63, -0.5, -0.36, -0.19, 0.01, 0.43, 0.81, 1.27, 1.75, 1.91, 1.82, 1.48, 1.14, 0.84, 0.37, 0.12, -0.09, -0.16, -0.19, -0.3, -0.39, -0.35, -0.49, -0.58, -0.72, -0.73, -0.84, -0.78, -0.7, -0.72, -0.49, -0.56, -0.56, -0.53, -0.34, -0.05, 0.31, 0.93, 1.21, 1.47, 1.43, 1.55, 1.1, 0.83, 0.48, 0.31, 0.12, -0.18, -0.09, -0.21, -0.24, -0.42, -0.39, -0.52, -0.58, -0.49, -0.49, -0.49, -0.42, -0.48, -0.58, -0.48, -0.51, -0.35, -0.3, 0.04, 0.2, 0.54, 0.83, 0.97, 1.37, 1.24, 1.04, 0.74, 0.47, 0.2, -0.03, -0.2, -0.31, -0.41, -0.39, -0.47, -0.42, -0.42, -0.43, -0.45, -0.42, -0.45, -0.43, -0.41, -0.33, -0.27, -0.33, -0.12, -0.05, 0.12, 0.36, 0.67, 0.86, 1.02, 1.21, 1.15, 0.95, 0.82, 0.39, 0.01, -0.24, -0.42, -0.51, -0.49, -0.52, -0.55, -0.54, -0.46, -0.51, -0.58, -0.55, -0.58, -0.36, -0.45, -0.39, -0.18, -0.19, -0.03, 0.12, 0.32, 0.52, 0.9, 1.19, 1.42, 1.53, 1.17, 1.03, 0.68, 0.43, 0.07, -0.14, -0.39, -0.41, -0.53, -0.58, -0.65, -0.69, -0.75, -0.71, -0.73, -0.71, -0.69, -0.55, -0.42, -0.35, -0.31, -0.28, -0.18, 0.19, 0.38, 0.72, 1.07, 1.3, 1.54, 1.48, 1.34, 1.07, 0.75, 0.44, 0.18, 0, -0.13, -0.31, -0.35, -0.5, -0.63, -0.66, -0.74, -0.78, -0.72, -0.7, -0.62, -0.67, -0.59, -0.45, -0.42, -0.37, -0.12, 0.16, 0.49, 0.77, 0.9, 1.24, 1.3, 1.22, 1.02, 0.86, 0.59, 0.21, 0.2, 0.05, -0.14, -0.28, -0.3, -0.43, -0.46, -0.43, -0.51, -0.57, -0.58, -0.58, -0.62, -0.47, -0.53, -0.49, -0.28, -0.13, 0, 0.29, 0.51, 0.56, 0.94, 1, 0.98, 0.72, 0.59, 0.41, 0.2, 0.06, -0.11, -0.2, -0.23, -0.24, -0.28, -0.31, -0.34, -0.36, -0.38, -0.31, -0.34, -0.35, -0.35, -0.31, -0.2, -0.18, -0.02, 0.17, 0.4, 0.54, 0.66, 0.79, 0.78, 0.77, 0.64, 0.36, 0.11, -0.03, -0.19, -0.26, -0.48, -0.42, -0.46, -0.45, -0.47, -0.49, -0.48, -0.47, -0.42, -0.39, -0.28, -0.22, -0.11, -0.05, 0.11, 0.35, 0.38, 0.67, 0.67, 0.98, 1.12, 1.02, 0.86, 0.67, 0.37, 0.2, -0.11, -0.23, -0.24, -0.42, -0.43, -0.56, -0.59, -0.65, -0.7, -0.65, -0.7, -0.58, -0.53, -0.47, -0.31, -0.17, -0.06, 0.08, 0.17, 0.49, 0.69, 0.9, 1.06, 1.11, 1.15, 0.98, 0.86, 0.53, 0.29, 0.05, -0.2, -0.22, -0.34, -0.42, -0.47, -0.54, -0.62, -0.67, -0.69, -0.66, -0.66, -0.6, -0.51, -0.42, -0.29, -0.19, -0.09, 0.11, 0.32, 0.51, 0.75, 0.95, 0.86, 1.02, 0.77, 0.68, 0.43, 0.15, 0.11, 0.03, -0.15, -0.1, -0.14, -0.28, -0.39, -0.43, -0.48, -0.51, -0.51, -0.43, -0.45, -0.31, -0.22, -0.23, -0.18, -0.16, 0.12, 0.28, 0.48, 0.64, 0.67, 0.67, 0.59, 0.36, 0.23, 0.01, 0.01, -0.08, -0.17, -0.22, -0.2, -0.3, -0.33, -0.37, -0.31, -0.38, -0.35, -0.35, -0.23, -0.11, -0.11, 0.07, -0.05, 0.12, 0.18, 0.41, 0.48, 0.59, 0.82, 0.55, 0.58, 0.29, 0.18, -0.1, -0.19, -0.28, -0.3, -0.3, -0.4, -0.44, -0.46, -0.5, -0.47, -0.5, -0.39, -0.35, -0.35, -0.27, 0.09, -0.05, 0.09, 0.15, 0.43, 0.6, 0.55, 0.79, 0.95, 0.83, 0.69, 0.65, 0.39, 0.14, -0.13, -0.14, -0.24, -0.3, -0.34, -0.47, -0.58, -0.58, -0.71, -0.66, -0.68, -0.57, -0.47, -0.41, -0.2, -0.15, -0.12, 0.13, 0.26, 0.34, 0.64, 0.75, 0.86, 1.08, 0.75, 0.75, 0.59, 0.29, 0.16, 0.16, 0.03, -0.05, -0.16, -0.29, -0.27, -0.5, -0.56, -0.46, -0.56, -0.5, -0.47, -0.38, -0.35, -0.27, -0.19, -0.1, 0.08, 0.18, 0.34, 0.47, 0.59, 0.54, 0.54, 0.51, 0.4, 0.28, 0.09, 0.01, -0.08, -0.03, -0.09, -0.17, -0.19, -0.25, -0.35, -0.39, -0.33, -0.39, -0.19, -0.15, 0, -0.09, 0, 0.04, 0.01, 0.28, 0.32, 0.43, 0.51, 0.49, 0.21, 0.21, 0.1, 0.01, -0.12, -0.23, -0.19, -0.27, -0.3, -0.35, -0.24, -0.31, -0.47, -0.35, -0.3, -0.2, -0.13, 0.02, 0.06, 0.12, 0.11, 0.23, 0.35, 0.49, 0.52, 0.61, 0.63, 0.59, 0.41, 0.28, 0.16, 0.04, -0.14, -0.27, -0.27, -0.36, -0.42, -0.43, -0.5, -0.52, -0.58, -0.49, -0.42, -0.41, -0.21, -0.14, 0.01, 0.08, 0.07, 0.27, 0.36, 0.52, 0.64, 0.74, 0.79, 0.71, 0.63, 0.51, 0.34, 0.06, 0, -0.12, -0.13, -0.14, -0.23, -0.43, -0.51, -0.55, -0.65, -0.52, -0.54, -0.54, -0.42, -0.31, -0.19, -0.18, -0.02, 0, 0.14, 0.24, 0.52, 0.71, 0.6, 0.57, 0.44, 0.39, 0.28, 0.08, 0.12, 0.02, -0.06, -0.08, -0.08, -0.12, -0.23, -0.35, -0.31, -0.25, -0.31, -0.24, -0.26, -0.19, -0.09, -0.09, 0.04, 0.06, 0.1, 0.08, 0.34, 0.2, 0.3, 0.2, 0.17, 0.02, 0, -0.16, -0.09, -0.19, -0.15, -0.12, -0.17, -0.19, -0.2, -0.19, -0.19, -0.21, -0.23, 0.03
#Bridge data
#-0.01, -0.01, -0.02, 0, 0, -0.01, 0.01, -0.02, 0, 0, 0, 0.02, 0, 0, 0, 0, 0.01, 0, -0.01, 0, 0, 0, 0, 0, -0.02, -0.02, 0.01, 0.02, -0.02, -0.01, -0.01, 0, -0.03, -0.01, -0.01, -0.01, -0.01, -0.02, -0.02, 0, 0.01, 0, 0, -0.01, 0, 0, 0, 0, 0.01, 0, 0, 0, 0, -0.01, 0.02, 0, 0, -0.02, 0, -0.01, -0.01, 0, 0.01, 0, -0.03, -0.01, 0, 0, 0, 0.01, 0, 0, 0, 0, 0.01, -0.01, 0, 0, -0.01, 0, 0, 0, 0, 0, -0.02, 0, -0.02, 0, 0, -0.01, 0, -0.01, 0, -0.01, 0, 0, 0.01, -0.03, -0.02, -0.01, 0, 0, 0, -0.01, 0, -0.02, -0.01, -0.02, 0.01, -0.01, 0, 0, 0, 0, 0.02, 0, 0, -0.01, -0.01, 0, 0, 0.01, -0.01, -0.01, 0, 0, -0.01, 0, -0.01, -0.01, -0.02, 0, -0.03, -0.01, -0.02, -0.02, -0.01, -0.01, 0, 0, 0, -0.01, -0.01, 0, 0, 0, -0.02, 0.01, -0.01, 0, 0, -0.02, -0.01, 0, 0, 0, 0, -0.01, -0.02, -0.01, 0, 0, 0, 0, -0.01, 0, 0, -0.01, -0.01, -0.01, 0, -0.01, -0.01, 0.01, -0.01, -0.01, -0.01, 0, 0, 0.01, 0, 0, -0.01, 0, -0.02, -0.01, 0, 0, 0, 0, -0.01, -0.01, -0.01, 0, -0.02, 0, -0.01, 0, -0.03, 0, -0.02, 0, -0.01, -0.01, 0, 0, 0, 0, -0.01, -0.01, 0, 0, 0, -0.02, -0.02, -0.02, -0.01, -0.01, -0.01, -0.02, 0, 0, -0.01, -0.01, -0.01, 0, -0.02, -0.01, 0, -0.02, 0, -0.02, 0, 0, -0.01, 0.02, -0.02, 0.02, 0, 0, 0, 0.01, 0, 0, 0.01, -0.02, 0, 0, 0, 0, 0, -0.01, -0.02, -0.01, -0.01, -0.01, 0, 0.01, 0, 0, 0, 0, -0.01, 0, 0, 0, -0.01, -0.02, -0.02, -0.02, 0, 0, 0, -0.01, 0, 0, 0, -0.01, 0, -0.01, 0, 0, -0.02, 0, 0, 0, 0, 0, 0, -0.01, -0.01, -0.01, -0.02, 0, 0.02, -0.02, -0.02, 0.02, 0, 0, -0.02, -0.01, -0.02, 0, -0.03, 0.02, 0, 0.02, 0, -0.01, -0.01, -0.01, 0.01, -0.03, -0.02, 0.02, 0, 0, 0, 0.01, 0, -0.03, 0, 0, -0.01, -0.01, -0.02, 0, 0, 0.01, -0.01, -0.01, -0.01, 0, 0, 0, 0, 0, -0.01, -0.01, -0.01, 0, 0, 0, -0.02, 0, -0.02, -0.02, 0, 0, 0, 0, 0, -0.01, 0, 0, 0, 0, 0, -0.01, 0, -0.01, 0, 0, -0.02, -0.02, -0.03, -0.01, 0, 0, -0.02, -0.01, -0.03, 0.02, 0, 0, -0.02, 0, -0.01, 0, 0, 0.02, -0.01, 0.02, 0, -0.01, -0.01, -0.03, -0.01, -0.02, 0, -0.02, 0, 0, -0.02, 0, -0.01, 0, -0.03, 0, 0, 0, 0, 0.01, -0.01, 0, 0, -0.01, -0.01, -0.02, -0.02, 0, 0, 0, 0, 0, 0, 0.01, 0, 0, 0, 0, -0.01, 0, -0.01, -0.04, -0.01, 0, 0, 0, 0, -0.01, -0.01, -0.01, 0, 0, -0.01, 0.01, 0.02, 0, -0.01, 0, 0, 0, 0, 0.02, -0.01, 0, -0.02, -0.04, 0, 0, -0.02, -0.01, -0.01, -0.02, -0.01, 0, 0, 0, -0.02, 0, 0, -0.01, 0, 0, 0, 0.01, 0, 0, 0, -0.02, 0, 0, 0, -0.02, -0.01, -0.01, 0, 0, -0.01, 0, 0.02, 0, 0, 0, -0.01, -0.01, 0, -0.01, 0, -0.01, -0.01, 0, 0, -0.01, 0, -0.01, 0.01, 0, 0, -0.02, 0, 0, 0, 0, -0.04, -0.03, 0, 0, 0, 0, 0.02, 0, 0, -0.01, 0, 0, -0.01, 0, 0.01, -0.02, 0.02, -0.02, 0, -0.02, -0.01, 0, 0, 0, 0, -0.01, 0, 0, 0, 0.01, -0.01, 0.01, 0, -0.01, 0, 0, 0, 0, 0, 0.01, 0, -0.02, 0, 0, -0.03, 0, 0, -0.02, -0.02, 0, 0, -0.02, 0.02, 0, -0.02, -0.02, 0, -0.01, -0.01, -0.01, 0, 0, 0.01, -0.01, -0.01, -0.02, -0.01, -0.01, 0, -0.01, -0.03, 0, -0.02, -0.02, 0, 0, -0.01, -0.02, 0, -0.01, 0.01, 0, -0.01, 0, 0, -0.02, 0, -0.02, 0.01, 0, -0.01, 0.01, 0, 0, 0, 0, -0.01, 0, -0.02, 0, 0, 0, 0.01, 0, -0.03, 0.02, 0, 0, 0, 0, 0.01, -0.02, -0.01, 0, 0, -0.02, 0, 0, 0, 0, -0.02, -0.02, 0, 0, 0, -0.01, 0.01, 0, -0.01, 0, -0.01, -0.02, 0, -0.02, -0.02, -0.01, 0, 0, 0, 0, 0, 0.01, 0.01, 0, 0, 0, 0, 0, -0.01, -0.01, 0, 0, -0.01, 0, 0.02, -0.01, 0.02, 0.01, -0.01, -0.02, 0, -0.02, 0, 0, -0.01, 0, 0, -0.02, 0, 0, 0, -0.02, -0.02, 0, 0, 0, 0, 0, 0.01, -0.03, 0, 0, 0, -0.01, 0, -0.02, -0.01, -0.01, 0, -0.01, -0.01, 0, -0.03, -0.01, 0, 0, -0.02, -0.01, 0, 0, 0, 0.01, -0.01, 0, 0.01, 0, 0, -0.01, -0.02, -0.01, -0.01, -0.02, -0.02, 0, 0.01, 0, 0, 0, 0, 0, 0, -0.01, -0.01, -0.01, 0.01, -0.01, -0.01, 0, 0, -0.02, 0.02, 0.01, 0, 0.01, 0, -0.02, 0, 0, -0.02, -0.01, 0.02, 0, -0.01, -0.02, 0.01, 0, 0, 0, -0.02, 0, 0, 0, 0, 0, 0.02, 0.01, 0, -0.01, 0.01, -0.01, 0, 0.01, 0, -0.02, 0.02, 0, 0, 0, -0.01, 0, -0.01, -0.01, -0.01, -0.02, -0.02, 0.01, 0, -0.01, 0, 0, -0.01, 0.01, 0.02, 0.02, -0.01, -0.02, -0.01, 0.01, 0, 0.02, 0, -0.01, -0.01, 0.02, 0, 0, -0.02, 0.01, -0.01, 0, -0.01, 0, 0, -0.01, -0.02, 0, 0, -0.01, 0, 0, 0, -0.03, -0.02, -0.03, -0.01, 0.02, 0, 0, 0.02, 0, -0.02, 0, -0.01, 0, 0, 0, -0.01, -0.03, 0, 0.01, 0.01, 0.01, 0, 0.02, 0, -0.01, -0.03, -0.03, -0.01, -0.02, -0.01, -0.01, -0.02, -0.01, 0, 0, -0.01, 0, 0.02, -0.03, -0.01, 0, -0.02, -0.01, -0.01, 0, 0.02, -0.01, 0.02, 0.01, 0, 0, -0.01, -0.02, -0.01, 0, 0, 0.01, 0.01, 0, 0, 0, 0.01, 0, 0, -0.01, 0, -0.02, 0.02, -0.02, 0.02, 0, 0, 0, 0.01, -0.01, 0, 0.01, -0.02, -0.01, 0, 0.02, 0, 0, 0, -0.02, -0.02, -0.01, -0.02, -0.01, -0.01, 0, -0.02, -0.01, -0.02, 0, -0.01, -0.03, 0.01, -0.02, 0.02, 0.02, 0, -0.02, -0.01, 0, 0, 0.02, 0, 0, -0.03, 0, 0.02, -0.02, -0.02, 0, 0, 0, 0, 0, 0, -0.02, -0.03, 0, 0.01, 0, -0.01, 0.02, 0.02, -0.03, -0.01, 0, 0, -0.02, 0, 0.02, 0, 0, -0.02, -0.01, 0, 0.02, 0, 0.01, 0, -0.01, -0.02, -0.01, 0.02, 0, 0.02, 0, 0, -0.01, -0.03, -0.01, 0, 0, -0.03, -0.01, 0, -0.02, 0, 0, 0, 0, 0, -0.01, 0, -0.01, -0.02, 0, 0, -0.04, -0.01, -0.03, 0.01, 0, 0, -0.02, 0, 0, 0, 0, 0, 0.02, 0.01, 0, 0.01, -0.02, 0, -0.01, -0.02, 0, -0.01, 0, -0.01, 0, -0.02, 0, 0, 0, 0, 0, -0.01, -0.02, -0.02, 0
#Bridge data 2
#-0.02, -0.01, 0, -0.01, -0.01, 0, 0.02, 0.02, 0, -0.01, 0.01, 0, 0, 0.01, -0.01, 0, -0.02, 0, 0, 0.01, 0, -0.02, -0.02, -0.01, -0.02, 0, 0, 0, 0, -0.02, 0, 0, 0, 0, -0.01, -0.02, -0.02, -0.02, 0, -0.01, 0, 0, 0, 0, -0.01, 0, 0, -0.02, 0, 0, 0, -0.01, -0.01, 0, 0, 0.02, -0.01, -0.03, 0, -0.01, -0.02, -0.03, -0.03, -0.01, 0, 0, 0, -0.02, 0, 0, 0, -0.03, 0, 0.02, 0, 0, 0, 0.01, -0.01, 0, 0, 0, 0.01, -0.01, -0.02, 0, -0.01, -0.02, 0, 0.01, 0.02, 0.01, -0.02, 0, 0, 0.01, -0.01, 0.02, 0, 0, 0, 0, 0, -0.01, 0, 0.01, -0.01, 0, 0, -0.02, 0.01, 0, 0, -0.01, 0, -0.02, 0, 0, 0, 0.01, -0.01, -0.04, -0.02, 0, -0.01, 0, 0, 0, 0, -0.01, 0, -0.02, -0.02, -0.01, -0.01, -0.01, 0.02, 0.02, 0, 0, -0.01, -0.01, 0, -0.01, -0.03, -0.01, 0.02, -0.01, -0.02, -0.01, 0, 0, -0.01, 0, -0.01, 0, -0.03, 0, -0.01, 0, -0.02, 0, -0.02, -0.02, 0.02, 0, 0, -0.02, -0.04, 0, -0.03, 0, -0.02, -0.02, 0, 0, 0, 0, 0, -0.02, -0.02, 0, -0.01, -0.04, 0, 0.02, -0.01, -0.02, 0, 0, -0.02, -0.01, 0, -0.01, -0.03, 0, -0.04, 0.01, 0, -0.02, 0, 0, 0, 0, -0.02, -0.02, 0, 0.02, 0, -0.02, -0.01, 0, -0.03, 0.02, 0, -0.01, 0, 0.02, -0.01, -0.03, -0.01, 0, 0, -0.01, -0.01, -0.02, -0.01, -0.01, 0, 0.01, -0.02, -0.01, 0, -0.03, 0, 0, -0.01, -0.02, 0, 0, -0.01, 0.01, 0, 0, -0.01, -0.01, -0.01, 0.02, 0, -0.01, -0.03, 0, -0.01, 0, 0, 0, -0.02, 0, -0.03, 0, -0.02, 0, 0, 0, 0, 0, 0, -0.02, 0, 0, 0, 0, 0, -0.01, -0.02, -0.02, -0.02, 0, 0, -0.02, 0, 0, -0.03, -0.01, -0.01, 0, 0.01, -0.02, -0.01, 0, 0, 0, -0.02, -0.02, 0, 0, 0, -0.01, -0.02, 0, -0.01, 0, -0.01, -0.01, -0.01, -0.01, -0.02, 0, -0.02, -0.01, -0.02, 0, -0.01, 0, -0.01, -0.02, 0, -0.03, 0, 0, 0, -0.02, -0.01, 0.01, 0, 0.02, 0, 0, 0, 0, 0, 0, 0, 0, -0.01, 0, -0.01, -0.03, -0.02, -0.02, 0, 0, 0, -0.03, 0.01, -0.02, 0, 0.02, 0, 0, 0, 0, -0.03, -0.01, 0.01, -0.03, 0, 0, 0, 0, 0, -0.01, -0.01, -0.01, -0.02, 0, -0.03, 0, -0.02, -0.02, -0.03, 0, 0, -0.01, 0, 0, -0.02, 0, -0.01, -0.01, 0, 0, 0, 0, -0.02, 0, 0, 0, 0, -0.02, -0.01, -0.02, 0, 0.01, 0, 0, 0.01, 0, 0.01, 0, 0, 0, 0, 0, 0, -0.01, -0.02, 0, 0, 0, -0.02, 0, -0.01, -0.02, -0.01, -0.01, 0.02, -0.01, 0, -0.04, 0, 0, 0, -0.01, 0, 0, -0.04, 0, 0.01, -0.01, 0, 0, -0.01, 0.01, -0.03, -0.01, 0, -0.01, -0.01, -0.01, -0.02, 0, -0.02, -0.01, 0, 0, 0, 0, 0.02, -0.02, 0, 0, 0, 0, 0.02, -0.02, 0.02, 0, 0, 0, 0, 0, -0.01, 0, 0, 0, -0.02, -0.01, 0.01, -0.04, -0.01, 0.01, -0.01, 0, 0, 0, -0.01, -0.01, 0, 0, 0, -0.01, 0, 0, 0, 0, 0, 0, -0.02, -0.01, -0.03, -0.02, -0.02, -0.01, 0.01, -0.02, 0, -0.02, 0, 0, -0.03, -0.02, -0.02, -0.02, 0.02, 0, 0, -0.02, 0, -0.02, -0.02, 0.02, -0.02, 0, 0, 0, -0.03, -0.02, 0.01, -0.02, -0.01, -0.03, 0, 0, 0, 0, -0.03, -0.02, -0.03, 0.01, 0, 0, 0, -0.01, 0, 0, -0.01, 0, -0.02, -0.02, 0, -0.01, 0, -0.02, 0, -0.05, 0.01, 0, 0, -0.02, 0, -0.02, -0.02, 0, 0, 0, 0, 0.02, 0, 0.01, 0, 0, -0.01, 0, -0.02, -0.01, -0.02, -0.01, 0, 0.01, -0.01, 0, 0, -0.01, 0, 0, 0, 0.02, 0.02, -0.02, 0, 0, 0.02, -0.01, 0, 0, -0.01, -0.01, 0, -0.01, 0.03, 0.02, -0.01, -0.01, 0.01, -0.02, 0, 0, 0.02, -0.02, -0.02, 0, 0, -0.03, -0.01, -0.01, 0, 0.01, 0.02, 0.01, 0, 0.01, -0.01, 0, -0.03, 0, 0, -0.02, 0, -0.01, 0, -0.01, 0, 0, -0.02, -0.01, 0, 0.02, 0, 0.01, -0.01, -0.01, 0.02, 0, 0, 0, -0.01, 0, -0.02, -0.01, -0.01, -0.01, -0.01, 0, 0, 0.02, 0.02, 0, -0.01, 0.02, 0, 0, 0, -0.02, -0.01, -0.01, 0.02, -0.02, 0, -0.02, -0.01, -0.02, -0.02, -0.03, 0, -0.02, 0, 0.02, 0, -0.01, 0, -0.02, 0, -0.01, 0.01, -0.01, 0, -0.01, 0, 0, -0.01, -0.01, -0.03, -0.02, 0, -0.02, 0.01, 0, -0.01, 0, -0.01, -0.03, 0, 0, 0.02, -0.02, 0, -0.02, 0, -0.02, 0.03, 0, -0.01, -0.02, 0, 0, 0, -0.02, 0, 0, 0, -0.01, 0, -0.01, -0.02, 0.01, -0.02, 0, 0, -0.03, -0.01, 0, 0, 0, -0.01, -0.02, 0, 0, 0, 0, -0.01, -0.01, 0, 0, -0.01, -0.02, 0, 0, 0.01, 0, -0.02, -0.02, -0.01, 0.01, -0.02, 0, -0.02, -0.02, 0, 0, 0, -0.02, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, 0, 0, 0, -0.02, 0, -0.02, -0.02, 0, 0, 0, -0.03, 0, -0.02, 0, -0.03, 0, -0.01, 0, 0, -0.02, 0, -0.01, 0, 0, 0, 0, 0.03, 0, -0.02, 0, 0, -0.01, -0.02, 0, 0, -0.02, 0.01, 0, -0.01, 0, 0, 0, -0.02, 0, -0.02, 0, -0.02, -0.02, -0.01, 0, -0.01, 0, 0, 0, 0, 0, 0, -0.02, -0.02, 0.01, 0.01, -0.01, -0.01, -0.02, 0, -0.02, 0, -0.03, -0.01, 0, -0.01, -0.01, 0, 0.01, 0, 0, 0, 0, 0, 0.02, -0.03, 0, 0.01, 0, -0.01, 0, -0.01, -0.03, 0, 0.02, 0, 0.01, 0, 0.02, 0, -0.03, 0, 0, 0, -0.02, -0.01, 0.02, -0.02, -0.03, -0.01, 0, -0.02, 0, -0.02, 0, 0, 0, -0.02, -0.01, -0.02, 0.01, 0, -0.01, 0, 0, -0.01, -0.02, 0, 0.01, 0, -0.02, -0.02, -0.02, 0, -0.01, 0, 0.01, 0, -0.01, -0.03, 0, 0, -0.01, 0.01, 0, -0.02, -0.01, 0, 0, 0, -0.01, -0.01, 0, 0.01, -0.02, 0, 0.01, 0, -0.03, 0, 0, 0, 0, 0, -0.01, -0.02, 0, -0.01, 0, 0, -0.01, 0.02, 0.02, -0.01, 0, 0.02, -0.01, -0.02, -0.01, 0.02, -0.01, 0, 0, -0.03, -0.01, 0.02, -0.02, -0.01, 0, 0.02, -0.03, 0, 0, -0.04, -0.02, 0.01, 0, 0.02, -0.01, -0.02, 0, -0.01, -0.01, -0.02, 0, 0, 0, 0.02, 0, 0, 0.01, 0, 0.02, 0, -0.01, 0, 0, 0.02, 0, 0.02, -0.02, 0, 0.02, 0, 0, -0.02, -0.01, -0.02, 0, 0.02, 0, 0, 0, -0.02, -0.02, -0.02, 0.01, -0.01, 0.01, 0, 0, 0, -0.01, 0, -0.01, -0.02, 0.04, -0.01, -0.01, -0.01, -0.02, 0, -0.01, 0, -0.02, 0, -0.01, -0.01, 0, 0, 0, 0, 0, 0.01, 0, -0.01, -0.02, 0, -0.02, 0, 0
#New Bridge data
#0.038, 0.043, -0.016, 0.041, -0.047, 0.004, 0.004, -0.011, -0.011, -0.033, -0.011, 0.036, 0.004, 0.002, 0.019, 0.023, -0.008, 0.009, 0.021, 0.011, -0.016, -0.042, 0.004, 0.019, -0.006, -0.057, 0.004, -0.001, -0.018, 0.006, -0.028, -0.003, 0.011, -0.011, 0.002, -0.008, -0.02, -0.04, 0.033, -0.02, 0.021, 0.033, -0.02, 0.019, 0.004, 0.014, -0.016, 0.016, 0.004, 0.021, -0.008, -0.025, 0.031, -0.003, -0.018, 0.023, 0.053, -0.011, -0.03, -0.018, -0.03, 0.016, 0.031, 0.002, -0.03, -0.035, 0.045, -0.028, -0.033, -0.003, -0.011, -0.013, -0.006, -0.001, 0.043, -0.028, -0.035, 0.004, -0.008, -0.016, 0.002, -0.011, -0.003, 0.023, 0.021, 0.011, 0.067, 0.006, 0.002, 0.045, 0.011, -0.008, -0.008, -0.001, 0.028, -0.04, 0.002, -0.038, -0.033, -0.033, 0.011, 0.058, -0.025, -0.033, -0.006, 0.002, 0.002, 0.004, -0.028, -0.025, 0.038, 0.014, 0.011, -0.011, 0.019, -0.033, -0.001, -0.04, -0.033, 0.002, -0.018, -0.02, -0.006, 0.004, 0.009, -0.008, -0.006, -0.001, -0.028, -0.011, 0.014, -0.011, -0.003, -0.023, -0.003, -0.006, 0.006, -0.033, -0.011, 0.004, -0.033, -0.016, -0.003, -0.03, 0.019, -0.006, 0.006, -0.023, 0.004, 0.009, 0.002, -0.011, 0.006, -0.013, -0.033, -0.035, 0.033, -0.001, -0.018, 0.016, -0.018, 0.038, 0.006, 0.023, 0.004, 0.036, 0.004, 0.033, -0.018, -0.001, 0.009, 0.009, -0.018, 0.009, 0.009, 0.021, 0.043, 0.009, -0.008, 0.004, 0.002, -0.006, 0.041, 0.019, -0.033, 0.009, 0.002, 0.026, -0.033, -0.016, 0.011, 0.011, -0.033, -0.016, -0.006, 0.011, -0.006, 0.021, -0.02, -0.011, 0.014, -0.016, -0.001, -0.006, 0.014, 0.014, 0.011, -0.016, -0.023, 0.023, 0.014, -0.001, 0.033, -0.042, -0.04, 0.006, -0.016, 0.004, -0.016, 0.004, 0.033, 0.019, 0.033, -0.018, 0.014, -0.001, 0.023, -0.055, -0.055, 0.023, -0.033, -0.011, 0.004, 0.011, -0.033, -0.016, -0.03, 0.014, -0.033, 0.002, -0.006, 0.023, 0.041, -0.018, -0.03, -0.084, -0.018, -0.003, -0.016, -0.001, 0.045, -0.035, -0.006, 0.016, 0.004, -0.016, -0.011, -0.001, -0.025, 0.021, 0.019, -0.006, 0.004, -0.033, -0.033, 0.006, 0.004, 0.014, -0.001, 0.031, -0.033, 0.016, -0.016, 0.009, 0.019, -0.028, -0.006, 0.009, -0.033, 0.033, 0.016, -0.016, -0.011, -0.001, -0.02, -0.016, -0.02, 0.031, 0.009, -0.001, -0.038, 0.014, 0.014, -0.016, -0.006, -0.02, -0.028, 0.002, 0.023, 0.014, -0.03, -0.001, -0.016, 0.023, -0.03, 0.016, -0.038, 0.014, 0.004, 0.023, 0.043, -0.011, 0.023, -0.008, -0.03, -0.008, -0.02, -0.028, 0.019, 0.014, -0.02, 0.045, -0.006, 0.009, -0.016, 0.004, 0.043, -0.025, -0.001, -0.018, 0.021, -0.016, 0.021, 0.048, -0.02, 0.028, 0.014, 0.009, -0.03, -0.018, -0.008, -0.025, -0.018, -0.001, -0.033, 0.023, 0.004, -0.025, -0.025, 0.004, -0.033, 0.045, 0.038, 0.014, -0.001, -0.003, -0.018, -0.018, 0.011, 0.004, -0.006, -0.001, 0.006, 0.004, -0.067, 0.021, 0.009, -0.018, -0.038, -0.006, -0.03, -0.008, 0.016, -0.001, -0.008, 0.002, 0.004, -0.033, -0.035, -0.016, 0.002, -0.013, -0.018, 0.004, -0.003, -0.033, -0.02, -0.006, 0.011, -0.006, 0.014, -0.06, 0.006, 0.006, 0.014, -0.001, -0.001, -0.008, 0.004, 0.019, -0.001, 0.004, -0.023, 0.006, -0.02, -0.02, 0.023, 0.014, 0.009, -0.028, -0.045, 0.009, 0.011, -0.006, -0.033, -0.025, -0.018, -0.006, -0.003, -0.011, -0.02, -0.025, -0.025, -0.02, -0.016, -0.035, -0.03, 0.006, 0.011, 0.014, -0.03, -0.018, -0.016, -0.016, -0.011, 0.004, -0.011, -0.001, -0.035, -0.018, -0.028, -0.023, -0.035, -0.006, -0.008, -0.028, 0.004, -0.045, 0.002, -0.025, 0.016, -0.028, -0.033, -0.018, -0.03, -0.072, -0.018, 0.004, -0.006, 0.028, 0.031, 0.031, -0.025, -0.001, -0.045, -0.086, 0.004, -0.008, -0.033, 0.041, 0.028, 0.002, -0.006, -0.011, -0.018, -0.016, -0.047, -0.018, -0.016, 0.004, -0.045, -0.016, -0.04, -0.028, 0.045, -0.028, 0.019, 0.021, 0.002, -0.011, -0.03, -0.006, -0.033, -0.006, -0.008, 0.011, 0.014, 0.009, 0.004, -0.035, -0.033, 0.014, -0.038, -0.033, -0.006, 0.038, 0.041, 0.002, -0.02, -0.033, -0.038, -0.038, -0.018, -0.003, -0.023, -0.008, -0.001, -0.008, -0.03, -0.001, 0.016, -0.02, -0.033, -0.028, 0.021, 0.009, 0.006, -0.033, -0.016, -0.006, 0.033, -0.03, -0.077, -0.003, 0.021, 0.004, -0.008, 0.004, 0.002, -0.016, -0.008, -0.016, -0.018, -0.006, -0.033, -0.055, 0.019, -0.018, -0.033, -0.006, -0.023, -0.028, -0.006, -0.025, 0.011, -0.006, 0.004, 0.033, 0.009, -0.001, 0.033, 0.004, -0.02, 0.014, -0.025, 0.009, -0.008, -0.001, 0.002, 0.004, 0.021, -0.023, -0.006, -0.011, 0.014, -0.011, 0.002, -0.033, -0.03, -0.008, 0.023, -0.025, -0.033, -0.038, -0.001, 0.045, 0.002, -0.006, -0.008, -0.084, -0.016, 0.021, -0.001, -0.003, 0.019, 0.009, 0.036, -0.001, 0.004, -0.008, -0.025, 0.004, -0.038, 0.019, -0.006, -0.016, 0.014, 0.004, -0.016, 0.08, -0.001, 0.014, 0.004, 0.004, -0.016, -0.016, -0.016, -0.016, -0.03, 0.053, -0.008, -0.011, -0.057, -0.03, -0.011, 0.002, 0.045, 0.011, 0.019, 0.045, -0.006, -0.02, -0.016, -0.038, -0.008, -0.001, 0.002, -0.013, 0.004, 0.045, 0.031, 0.004, 0.038, -0.003, -0.006, -0.018, -0.045, -0.016, -0.028, -0.033, 0.023, -0.003, -0.016, -0.003, -0.016, 0.009, -0.003, 0.014, -0.033, 0.011, 0.014, 0.023, 0.006, -0.025, 0.014, 0.019, 0.053, 0.023, -0.025, -0.006, -0.001, -0.025, -0.033, 0.002, 0.023, -0.033, -0.047, -0.006, -0.03, -0.003, -0.023, 0.023, -0.003, 0.023, -0.006, 0.009, 0.002, 0.002, -0.033, 0.033, -0.033, -0.008, 0.023, -0.033, 0.023, 0.011, 0.004, -0.018, 0.021, 0.011, 0.004, -0.025, 0.006, 0.002, -0.013, 0.002, 0.011, -0.001, -0.028, -0.016, -0.033, 0.014, -0.001, 0.004, -0.028, 0.004, 0.006, 0.031, -0.025, -0.028, -0.062, -0.045, 0.028, 0.023, 0.002, 0.009, -0.033, 0.053, -0.008, 0.014, 0.033, -0.06, -0.016, 0.011, -0.001, -0.003, -0.035, -0.011, -0.011, -0.025, -0.02, -0.03, 0.028, 0.004, -0.028, 0.019, -0.001, 0.009, 0.043, -0.05, -0.016, 0.011, 0.004, 0.011, 0.002, -0.033, 0.004, 0.006, 0.019, -0.02, -0.006, -0.008, -0.028, 0.002, 0.004, -0.057, -0.018, -0.023, -0.042, -0.011, 0.011, 0.009, -0.016, 0.004, -0.008, 0.028, 0.033, -0.001, -0.02, -0.006, -0.033, 0.019, -0.001, -0.018, -0.025, 0.011, -0.008, 0.014, -0.028, 0.019, -0.003, -0.016, 0.041, 0.006, 0.004, -0.033, 0.004, 0.002, -0.016, -0.045, -0.033, -0.008, -0.023, -0.025, -0.011, 0.033, 0.023, -0.001, 0.014, -0.025, -0.025, -0.016, 0.014, -0.006, -0.025, -0.033, -0.033, -0.016, -0.033, -0.018, 0.023, 0.006, -0.023, 0.011, 0.019, -0.016, -0.003, -0.013, -0.018, -0.016, -0.033, -0.008, 0.014, -0.018, 0.002, 0.002, -0.001, -0.011, -0.02, 0.009, -0.001, -0.023, -0.016, -0.008, 0.004, 0.014, 0.002, -0.011, -0.023, -0.025, -0.008, -0.011, -0.025, -0.001, -0.006, -0.028, -0.001, -0.018, 0.023, -0.006, -0.006, 0.002, 0.014, -0.018, 0.028, 0.014, -0.033, -0.025, 0.021, -0.008, 0.045, -0.011, -0.006, -0.018, -0.084, -0.006, 0.006, -0.06, -0.001, -0.003, 0.002, -0.016, -0.025, -0.03, 0.023, -0.02, -0.033, 0.002, 0.033, 0.033, 0.004, 0.006, -0.008, -0.025, 0.043, 0.014, -0.016, -0.006, -0.006, -0.001, -0.025, -0.033, -0.008, 0.002, 0.002, 0.019, -0.008, -0.011, 0.011, -0.028, -0.018, -0.016, 0.011, -0.016, 0.026, 0.009, 0.031, 0.014, 0.023, 0.011, 0.004, -0.025, 0.033, -0.001, -0.011, -0.001, 0.004, -0.025, -0.033, 0.011, 0.019, 0.014, -0.006, 0.004, 0.043, 0.043, -0.055, -0.008, 0.036, 0.033, -0.006, 0.014, 0.043, -0.03, 0.038, 0.045, 0.05, -0.008, -0.018, 0.011, 0.019, 0.045, 0.002, -0.033, -0.033, -0.028, 0.023, 0.002, -0.008, 0.006, 0.019, -0.006, -0.016, 0.009, -0.001, -0.016, 0.021, 0.009, -0.033, -0.011, 0.002, -0.033, 0.004, -0.018, 0.004, 0.023, 0.033, -0.033, 0.036, -0.023, -0.033, -0.013, -0.045, -0.033, -0.02, -0.033, 0.006, 0.021, -0.008, 0.019, 0.004, 0.038, -0.025, -0.016, 0.033, 0.031, 0.004, -0.033, -0.038, 0.011, -0.025, -0.008, -0.02, 0.002, -0.006, -0.008, -0.035, -0.016, -0.03, -0.016, -0.02, -0.008, 0.014, -0.003, 0.014, 0.019, -0.016, -0.025, 0.006, -0.001, -0.008, 0.011, 0.009, -0.013
#0, 0, 0.01, 0.01, -0.01, 0, 0.02, -0.01, 0, 0, 0, -0.01, -0.02, 0.02, 0, -0.02, -0.01, -0.02, 0.02, 0, 0, -0.02, 0, 0, -0.02, 0.02, -0.01, 0, 0, 0.03, 0, -0.03, 0, 0.02, 0.01, 0, 0, 0, 0, -0.04, 0, -0.03, 0.02, 0.02, -0.02, 0, -0.01, 0, -0.01, 0, -0.03, 0, -0.01, 0.02, 0, -0.01, -0.01, 0, -0.04, 0, 0, 0, -0.02, 0, -0.02, 0, -0.01, -0.01, -0.01, -0.01, 0, 0, 0, 0.01, -0.04, 0, 0, 0, 0.01, -0.01, -0.01, -0.01, -0.02, 0.01, 0, 0, -0.01, 0, 0, -0.01, 0, -0.01, -0.01, 0, -0.01, 0, -0.02, 0, 0, 0, 0, 0, 0, 0.02, -0.02, 0, -0.01, 0, -0.01, 0, 0, -0.01, -0.03, -0.01, -0.02, -0.01, 0, 0.01, 0, 0, 0, -0.01, 0.01, 0, 0.02, -0.01, 0, 0.02, 0, 0, 0, 0, -0.02, -0.01, 0, -0.01, 0, -0.03, 0, 0.01, -0.01, 0, 0.01, 0, -0.03, -0.02, -0.01, -0.03, 0, 0, 0.02, 0, -0.02, 0, -0.01, 0, 0, 0, -0.01, 0.02, -0.01, -0.03, 0.02, -0.01, 0, 0, 0, -0.02, 0, 0, 0, -0.01, 0, 0, -0.01, 0.01, -0.02, 0, 0, -0.02, 0, 0, -0.02, -0.02, -0.02, 0, -0.01, 0, -0.02, 0, 0, 0, 0, -0.01, 0.02, -0.02, 0, 0, 0, -0.01, 0, 0, 0, 0, -0.02, -0.01, -0.01, 0, -0.03, -0.01, -0.01, 0, 0.02, -0.01, -0.02, -0.02, -0.02, 0, 0, 0.01, 0, 0, -0.01, -0.01, 0, 0, -0.02, -0.02, 0, -0.01, -0.01, 0, 0.01, 0, -0.01, 0, -0.01, -0.02, 0, 0, 0.01, 0, -0.02, -0.01, 0.02, -0.01, -0.03, -0.03, -0.01, -0.02, 0, 0, 0, 0, -0.01, 0, 0, 0, -0.03, 0, 0, 0, 0, -0.01, -0.02, 0, 0, -0.03, -0.02, 0, -0.02, 0, 0.01, 0.02, -0.01, -0.01, 0.02, 0.01, -0.01, -0.01, 0, -0.06, 0, -0.01, 0.02, 0.02, 0.01, -0.02, 0, 0, 0.02, -0.01, 0, 0.02, -0.01, 0, 0.02, 0, -0.04, 0.01, 0.02, -0.01, 0.01, 0, -0.01, -0.02, 0, -0.02, -0.03, 0, 0, 0, 0, 0.01, -0.01, -0.02, -0.02, -0.02, -0.01, -0.01, 0, -0.02, -0.03, -0.01, -0.02, 0, -0.03, 0, 0, 0, -0.02, -0.01, 0.01, 0, 0, 0, 0.01, 0.03, 0, 0, -0.01, 0.02, 0, 0, 0.01, 0, 0, 0.02, 0, 0, 0, -0.01, 0.02, 0, -0.01, 0, -0.02, -0.01, 0, 0, 0, -0.02, 0, 0, 0, 0.02, -0.01, -0.01, -0.01, 0, -0.02, -0.01, -0.01, -0.02, 0, -0.02, 0.02, 0.01, -0.02, 0.02, 0, 0, 0.01, -0.01, -0.01, 0, -0.01, 0, 0, 0, 0.01, -0.01, 0, 0, -0.02, 0, 0, -0.01, -0.01, -0.01, 0, -0.01, -0.01, 0, 0, 0, 0, 0.01, -0.01, 0, 0, 0, -0.02, 0, 0, 0, -0.04, -0.03, 0, 0, 0, -0.02, 0, 0.02, -0.02, 0.02, 0, 0.02, -0.02, 0, 0, -0.02, -0.01, 0, 0, 0, 0, 0.02, 0.02, 0, 0, 0, -0.01, 0, 0, 0, -0.01, 0, 0, -0.03, 0, 0.01, -0.02, -0.03, 0, -0.02, 0, 0, 0.02, -0.01, 0, 0, -0.02, 0, 0.02, 0, -0.01, -0.01, -0.01, 0, 0, 0, -0.03, -0.03, -0.01, -0.01, 0, -0.02, -0.02, 0.01, -0.02, 0, -0.01, -0.02, 0, 0.02, 0, 0, -0.01, -0.02, 0.01, 0, 0, -0.02, -0.01, 0.02, -0.01, 0.01, 0, -0.01, 0, 0, 0, 0.02, -0.04, 0, -0.02, -0.01, 0, 0, 0, -0.01, 0, -0.02, 0, 0, -0.03, 0, 0.02, 0, -0.02, -0.01, 0, 0, 0, -0.03, 0, 0, 0, 0, -0.03, 0, 0, 0, 0.02, -0.02, 0, 0, -0.01, 0, 0, -0.01, 0, -0.01, 0.02, 0.01, -0.02, 0, -0.02, -0.02, 0, -0.02, 0, 0, 0.01, 0.01, -0.01, 0, -0.02, 0, 0, 0, 0, 0, -0.01, -0.03, -0.01, 0, -0.02, 0, -0.02, -0.01, 0, 0, -0.02, 0.01, 0, 0, -0.01, -0.02, -0.02, 0, 0, -0.01, 0, 0, -0.01, 0, -0.01, 0.01, 0, -0.03, 0, 0, -0.01, -0.03, 0, -0.01, -0.02, 0.01, 0, -0.02, -0.01, -0.01, 0.02, 0, 0, -0.02, -0.03, -0.02, 0, 0, 0.01, 0, 0, 0, 0, 0, -0.01, -0.01, 0, -0.01, 0, -0.02, 0.02, 0, -0.02, 0, 0.02, -0.02, 0, 0.01, 0, 0.01, 0, 0, 0, 0, 0, 0, -0.02, 0, -0.02, 0, 0, -0.01, -0.01, 0, -0.03, 0, 0, 0.02, -0.02, 0, 0, -0.02, 0, -0.01, 0, 0, 0, -0.01, 0, 0, -0.02, 0, -0.02, -0.02, 0, 0.01, 0.01, 0, -0.01, 0, 0, 0, 0, -0.01, -0.02, 0.02, 0, -0.02, -0.01, 0, 0, 0, 0, -0.01, 0, -0.01, -0.02, 0, 0, 0.02, 0, 0, -0.02, 0.01, -0.01, 0, 0, -0.01, 0, 0, -0.03, -0.02, 0, 0.02, -0.01, -0.01, 0.01, -0.01, 0, -0.02, 0, 0, 0, 0, -0.02, 0, 0, -0.02, 0.02, 0.01, -0.01, 0.01, -0.01, -0.01, 0.01, 0, 0, 0.01, 0.02, 0, -0.01, 0, 0.01, 0, 0, -0.01, 0, -0.02, -0.03, 0, 0, 0, -0.02, 0.01, 0, 0, -0.01, 0, 0, 0, 0, -0.02, 0.01, 0.02, -0.01, 0, -0.01, -0.02, 0.01, -0.02, -0.01, 0, 0, -0.02, 0, 0, 0.02, -0.02, -0.01, 0, 0, 0, 0, -0.02, -0.02, -0.04, 0, 0.01, 0, 0.02, -0.03, -0.02, -0.03, -0.01, 0, 0, -0.02, 0, -0.04, 0, -0.02, 0, -0.03, -0.02, 0, 0.02, 0, 0, 0, -0.01, 0.02, -0.01, -0.01, -0.01, -0.02, 0, -0.01, 0, 0, 0, -0.01, -0.02, 0.02, 0, -0.02, -0.01, 0, -0.01, -0.02, 0, 0, -0.01, -0.01, -0.02, 0, 0, -0.02, 0.01, 0, 0, -0.03, 0, 0, 0, 0, -0.02, -0.02, -0.01, -0.01, 0.02, -0.01, -0.01, -0.01, 0, 0, -0.02, -0.02, 0, -0.04, 0, -0.04, 0, -0.02, 0, 0, -0.03, -0.01, -0.01, -0.01, -0.02, -0.01, -0.01, -0.03, 0, -0.02, 0, 0, 0.02, 0, 0, -0.01, -0.02, 0.02, 0, 0, 0, 0.02, 0.02, -0.02, 0, -0.02, 0, -0.02, 0.01, 0, 0, 0, 0, -0.03, 0, -0.02, -0.01, -0.05, -0.01, 0, 0, 0.01, 0, -0.04, 0, 0, 0, 0, -0.02, 0.01, -0.01, 0, -0.01, 0, -0.01, -0.02, -0.02, -0.02, -0.01, -0.02, 0, 0, -0.01, -0.01, 0, -0.01, 0, -0.02, 0, -0.02, -0.01, -0.02, 0, -0.02, -0.01, 0, -0.03, 0.01, 0, -0.02, 0.02, -0.01, 0.01, 0.02, 0.02, 0, 0, -0.02, 0, 0, -0.01, 0, 0, 0, 0, 0.02, 0, -0.02, -0.01, 0, 0.01, -0.02, 0, 0, 0.02, 0, -0.01, 0, -0.02, 0, 0, -0.02, 0, -0.01, -0.02, -0.02, -0.02, 0, -0.03, -0.01, 0, -0.02, -0.02, -0.03, -0.02, -0.01, -0.01, -0.01, 0, -0.01, 0, -0.01, 0.02, 0, -0.01, -0.02, -0.01, 0, 0.01, 0, 0, 0, -0.02, -0.03, 0, 0.02, -0.02, -0.01, -0.02, -0.01, -0.01, 0, 0, 0, 0, -0.01, -0.02, 0, 0, 0.02, -0.03, -0.02, 0, -0.02, -0.02, 
#-0.02, -0.01, 0, -0.01, -0.01, 0, 0.02, 0.02, 0, -0.01, 0.01, 0, 0, 0.01, -0.01, 0, -0.02, 0, 0, 0.01, 0, -0.02, -0.02, -0.01, -0.02, 0, 0, 0, 0, -0.02, 0, 0, 0, 0, -0.01, -0.02, -0.02, -0.02, 0, -0.01, 0, 0, 0, 0, -0.01, 0, 0, -0.02, 0, 0, 0, -0.01, -0.01, 0, 0, 0.02, -0.01, -0.03, 0, -0.01, -0.02, -0.03, -0.03, -0.01, 0, 0, 0, -0.02, 0, 0, 0, -0.03, 0, 0.02, 0, 0, 0, 0.01, -0.01, 0, 0, 0, 0.01, -0.01, -0.02, 0, -0.01, -0.02, 0, 0.01, 0.02, 0.01, -0.02, 0, 0, 0.01, -0.01, 0.02, 0, 0, 0, 0, 0, -0.01, 0, 0.01, -0.01, 0, 0, -0.02, 0.01, 0, 0, -0.01, 0, -0.02, 0, 0, 0, 0.01, -0.01, -0.04, -0.02, 0, -0.01, 0, 0, 0, 0, -0.01, 0, -0.02, -0.02, -0.01, -0.01, -0.01, 0.02, 0.02, 0, 0, -0.01, -0.01, 0, -0.01, -0.03, -0.01, 0.02, -0.01, -0.02, -0.01, 0, 0, -0.01, 0, -0.01, 0, -0.03, 0, -0.01, 0, -0.02, 0, -0.02, -0.02, 0.02, 0, 0, -0.02, -0.04, 0, -0.03, 0, -0.02, -0.02, 0, 0, 0, 0, 0, -0.02, -0.02, 0, -0.01, -0.04, 0, 0.02, -0.01, -0.02, 0, 0, -0.02, -0.01, 0, -0.01, -0.03, 0, -0.04, 0.01, 0, -0.02, 0, 0, 0, 0, -0.02, -0.02, 0, 0.02, 0, -0.02, -0.01, 0, -0.03, 0.02, 0, -0.01, 0, 0.02, -0.01, -0.03, -0.01, 0, 0, -0.01, -0.01, -0.02, -0.01, -0.01, 0, 0.01, -0.02, -0.01, 0, -0.03, 0, 0, -0.01, -0.02, 0, 0, -0.01, 0.01, 0, 0, -0.01, -0.01, -0.01, 0.02, 0, -0.01, -0.03, 0, -0.01, 0, 0, 0, -0.02, 0, -0.03, 0, -0.02, 0, 0, 0, 0, 0, 0, -0.02, 0, 0, 0, 0, 0, -0.01, -0.02, -0.02, -0.02, 0, 0, -0.02, 0, 0, -0.03, -0.01, -0.01, 0, 0.01, -0.02, -0.01, 0, 0, 0, -0.02, -0.02, 0, 0, 0, -0.01, -0.02, 0, -0.01, 0, -0.01, -0.01, -0.01, -0.01, -0.02, 0, -0.02, -0.01, -0.02, 0, -0.01, 0, -0.01, -0.02, 0, -0.03, 0, 0, 0, -0.02, -0.01, 0.01, 0, 0.02, 0, 0, 0, 0, 0, 0, 0, 0, -0.01, 0, -0.01, -0.03, -0.02, -0.02, 0, 0, 0, -0.03, 0.01, -0.02, 0, 0.02, 0, 0, 0, 0, -0.03, -0.01, 0.01, -0.03, 0, 0, 0, 0, 0, -0.01, -0.01, -0.01, -0.02, 0, -0.03, 0, -0.02, -0.02, -0.03, 0, 0, -0.01, 0, 0, -0.02, 0, -0.01, -0.01, 0, 0, 0, 0, -0.02, 0, 0, 0, 0, -0.02, -0.01, -0.02, 0, 0.01, 0, 0, 0.01, 0, 0.01, 0, 0, 0, 0, 0, 0, -0.01, -0.02, 0, 0, 0, -0.02, 0, -0.01, -0.02, -0.01, -0.01, 0.02, -0.01, 0, -0.04, 0, 0, 0, -0.01, 0, 0, -0.04, 0, 0.01, -0.01, 0, 0, -0.01, 0.01, -0.03, -0.01, 0, -0.01, -0.01, -0.01, -0.02, 0, -0.02, -0.01, 0, 0, 0, 0, 0.02, -0.02, 0, 0, 0, 0, 0.02, -0.02, 0.02, 0, 0, 0, 0, 0, -0.01, 0, 0, 0, -0.02, -0.01, 0.01, -0.04, -0.01, 0.01, -0.01, 0, 0, 0, -0.01, -0.01, 0, 0, 0, -0.01, 0, 0, 0, 0, 0, 0, -0.02, -0.01, -0.03, -0.02, -0.02, -0.01, 0.01, -0.02, 0, -0.02, 0, 0, -0.03, -0.02, -0.02, -0.02, 0.02, 0, 0, -0.02, 0, -0.02, -0.02, 0.02, -0.02, 0, 0, 0, -0.03, -0.02, 0.01, -0.02, -0.01, -0.03, 0, 0, 0, 0, -0.03, -0.02, -0.03, 0.01, 0, 0, 0, -0.01, 0, 0, -0.01, 0, -0.02, -0.02, 0, -0.01, 0, -0.02, 0, -0.05, 0.01, 0, 0, -0.02, 0, -0.02, -0.02, 0, 0, 0, 0, 0.02, 0, 0.01, 0, 0, -0.01, 0, -0.02, -0.01, -0.02, -0.01, 0, 0.01, -0.01, 0, 0, -0.01, 0, 0, 0, 0.02, 0.02, -0.02, 0, 0, 0.02, -0.01, 0, 0, -0.01, -0.01, 0, -0.01, 0.03, 0.02, -0.01, -0.01, 0.01, -0.02, 0, 0, 0.02, -0.02, -0.02, 0, 0, -0.03, -0.01, -0.01, 0, 0.01, 0.02, 0.01, 0, 0.01, -0.01, 0, -0.03, 0, 0, -0.02, 0, -0.01, 0, -0.01, 0, 0, -0.02, -0.01, 0, 0.02, 0, 0.01, -0.01, -0.01, 0.02, 0, 0, 0, -0.01, 0, -0.02, -0.01, -0.01, -0.01, -0.01, 0, 0, 0.02, 0.02, 0, -0.01, 0.02, 0, 0, 0, -0.02, -0.01, -0.01, 0.02, -0.02, 0, -0.02, -0.01, -0.02, -0.02, -0.03, 0, -0.02, 0, 0.02, 0, -0.01, 0, -0.02, 0, -0.01, 0.01, -0.01, 0, -0.01, 0, 0, -0.01, -0.01, -0.03, -0.02, 0, -0.02, 0.01, 0, -0.01, 0, -0.01, -0.03, 0, 0, 0.02, -0.02, 0, -0.02, 0, -0.02, 0.03, 0, -0.01, -0.02, 0, 0, 0, -0.02, 0, 0, 0, -0.01, 0, -0.01, -0.02, 0.01, -0.02, 0, 0, -0.03, -0.01, 0, 0, 0, -0.01, -0.02, 0, 0, 0, 0, -0.01, -0.01, 0, 0, -0.01, -0.02, 0, 0, 0.01, 0, -0.02, -0.02, -0.01, 0.01, -0.02, 0, -0.02, -0.02, 0, 0, 0, -0.02, -0.01, -0.01, -0.01, -0.02, -0.02, -0.02, 0, 0, 0, -0.02, 0, -0.02, -0.02, 0, 0, 0, -0.03, 0, -0.02, 0, -0.03, 0, -0.01, 0, 0, -0.02, 0, -0.01, 0, 0, 0, 0, 0.03, 0, -0.02, 0, 0, -0.01, -0.02, 0, 0, -0.02, 0.01, 0, -0.01, 0, 0, 0, -0.02, 0, -0.02, 0, -0.02, -0.02, -0.01, 0, -0.01, 0, 0, 0, 0, 0, 0, -0.02, -0.02, 0.01, 0.01, -0.01, -0.01, -0.02, 0, -0.02, 0, -0.03, -0.01, 0, -0.01, -0.01, 0, 0.01, 0, 0, 0, 0, 0, 0.02, -0.03, 0, 0.01, 0, -0.01, 0, -0.01, -0.03, 0, 0.02, 0, 0.01, 0, 0.02, 0, -0.03, 0, 0, 0, -0.02, -0.01, 0.02, -0.02, -0.03, -0.01, 0, -0.02, 0, -0.02, 0, 0, 0, -0.02, -0.01, -0.02, 0.01, 0, -0.01, 0, 0, -0.01, -0.02, 0, 0.01, 0, -0.02, -0.02, -0.02, 0, -0.01, 0, 0.01, 0, -0.01, -0.03, 0, 0, -0.01, 0.01, 0, -0.02, -0.01, 0, 0, 0, -0.01, -0.01, 0, 0.01, -0.02, 0, 0.01, 0, -0.03, 0, 0, 0, 0, 0, -0.01, -0.02, 0, -0.01, 0, 0, -0.01, 0.02, 0.02, -0.01, 0, 0.02, -0.01, -0.02, -0.01, 0.02, -0.01, 0, 0, -0.03, -0.01, 0.02, -0.02, -0.01, 0, 0.02, -0.03, 0, 0, -0.04, -0.02, 0.01, 0, 0.02, -0.01, -0.02, 0, -0.01, -0.01, -0.02, 0, 0, 0, 0.02, 0, 0, 0.01, 0, 0.02, 0, -0.01, 0, 0, 0.02, 0, 0.02, -0.02, 0, 0.02, 0, 0, -0.02, -0.01, -0.02, 0, 0.02, 0, 0, 0, -0.02, -0.02, -0.02, 0.01, -0.01, 0.01, 0, 0, 0, -0.01, 0, -0.01, -0.02, 0.04, -0.01, -0.01, -0.01, -0.02, 0, -0.01, 0, -0.02, 0, -0.01, -0.01, 0, 0, 0, 0, 0, 0.01, 0, -0.01, -0.02, 0, -0.02, 0, 0
#Best so far
#0, 0, -0.02, -0.01, -0.02, -0.03, 0.01, 0, 0, 0, -0.02, 0, -0.01, 0, 0.01, -0.01, 0.01, 0, 0, -0.02, 0.02, -0.01, 0, -0.01, 0.01, 0.02, 0.02, 0.01, 0.02, 0, 0, -0.01, 0, 0, 0, 0, 0, -0.01, -0.02, 0, -0.01, 0, -0.01, -0.01, 0, -0.01, -0.01, -0.02, 0, 0.01, -0.01, -0.02, 0, -0.01, -0.02, -0.03, 0, -0.01, 0, 0, 0, -0.02, 0, -0.02, -0.01, -0.02, 0, 0, 0.01, 0.02, 0, 0, 0, 0.02, 0.03, -0.01, 0, 0, 0, 0, 0, 0, 0, 0.01, 0, 0.01, 0, 0, -0.01, -0.02, 0, -0.02, 0, -0.01, -0.01, -0.02, 0, -0.01, -0.02, 0, -0.02, 0, -0.01, -0.03, -0.01, -0.03, 0, -0.01, 0, -0.01, -0.01, -0.02, -0.02, -0.03, 0, -0.03, -0.02, -0.02, 0, 0, 0, 0, 0, 0.02, 0, 0, 0, 0, 0.02, 0, 0, 0.02, 0.03, -0.01, 0.02, 0.01, 0.02, 0, 0, 0, -0.01, 0, -0.01, 0, -0.01, 0, 0, 0, 0, -0.01, -0.03, -0.02, 0, -0.02, -0.02, -0.03, -0.02, -0.02, -0.02, -0.03, -0.02, -0.02, -0.02, -0.03, -0.02, -0.02, -0.01, -0.03, -0.01, -0.01, -0.01, -0.01, 0, -0.01, 0, 0.01, -0.04, 0, 0, -0.02, 0, 0, 0, -0.01, 0.01, 0.02, 0, 0.02, 0, 0, -0.01, 0, 0, 0, 0, 0.01, 0, 0, 0, 0, -0.01, 0, -0.01, -0.01, -0.02, 0, -0.01, 0, 0, 0, 0, -0.02, 0, 0, -0.01, -0.01, 0, 0, -0.01, -0.01, 0, -0.01, 0, -0.01, 0, 0, 0, 0, 0.01, 0, 0.01, 0, -0.01, 0, 0, 0, 0, 0, 0, 0.02, -0.01, 0, 0, 0, 0, 0, 0.01, -0.01, 0, -0.01, 0, 0, -0.03, -0.03, 0, 0, 0, 0, -0.01, -0.04, 0, -0.01, -0.01, 0, -0.02, -0.01, -0.02, -0.03, -0.02, -0.02, -0.02, -0.02, 0, 0, -0.02, -0.02, 0, -0.02, 0, -0.01, 0, -0.01, 0, 0, 0, 0, -0.02, 0.02, 0.02, 0, 0, -0.02, 0, 0, 0.02, 0.02, 0, 0, -0.01, 0, 0, 0, 0, 0, -0.02, 0, 0, 0, -0.02, 0, 0, 0, -0.01, 0.01, 0, -0.02, -0.02, -0.02, 0, -0.02, 0, -0.01, -0.03, -0.02, -0.02, 0, -0.01, -0.01, -0.02, -0.01, -0.01, -0.01, -0.01, -0.01, -0.02, -0.04, 0, 0.01, 0.01, 0.02, 0, 0.02, -0.01, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.02, 0, -0.01, 0, 0, 0.02, 0, 0, 0, -0.02, 0, -0.01, -0.01, -0.01, -0.01, -0.01, 0, -0.01, -0.01, -0.01, 0, 0, -0.03, 0.01, -0.01, -0.01, -0.02, 0, 0, 0, -0.01, -0.01, 0, -0.02, -0.03, 0, 0, 0, -0.02, 0, 0.02, 0.01, 0, 0, 0.01, 0.01, 0, 0, -0.02, 0.01, 0, 0.02, -0.01, -0.01, -0.01, 0, 0, 0, -0.01, -0.01, 0, -0.01, -0.01, 0, 0, -0.02, -0.02, 0.01, 0, -0.02, -0.04, -0.02, 0, -0.02, -0.02, -0.04, -0.01, -0.01, 0, -0.02, -0.02, 0, 0, 0.01, -0.01, 0, -0.01, 0, 0.01, 0, 0, 0, 0, 0.01, -0.01, 0, 0, 0.02, 0, 0.02, -0.02, 0, 0, 0.02, 0, 0.02, 0, 0, 0, 0, 0, 0, 0.02, -0.02, 0, 0, 0, -0.02, 0.02, 0, 0, -0.02, 0, -0.02, -0.02, 0, 0, -0.01, -0.02, 0, 0, -0.02, -0.02, -0.02, -0.04, -0.01, -0.01, -0.01, 0, 0, -0.01, 0, 0, 0, 0, 0, -0.01, 0, 0.02, 0, 0, 0.02, -0.01, 0, -0.02, 0.01, -0.01, 0.01, 0, 0, 0, 0, 0, 0, -0.01, 0, 0, -0.01, 0, 0, -0.02, 0, -0.01, -0.02, 0.02, -0.02, 0, 0, -0.02, -0.03, -0.03, -0.02, -0.04, -0.03, 0.01, -0.01, -0.03, -0.01, -0.01, -0.02, 0, 0, -0.02, 0, 0, 0, -0.01, 0, -0.01, 0, 0, 0, 0, 0.02, 0.02, 0.01, 0, 0.02, 0, 0.02, 0.02, -0.02, 0, 0, -0.02, 0, -0.01, 0, 0, 0, -0.02, 0, 0, 0.02, 0, 0, 0, -0.02, -0.01, 0, -0.01, 0, 0, -0.04, -0.01, -0.02, -0.01, -0.03, -0.02, -0.02, 0, -0.02, 0, 0, 0, -0.02, 0, -0.01, -0.01, -0.01, 0, 0, 0, -0.01, 0.02, 0.02, 0.01, 0, 0, 0, 0, -0.01, 0, 0, 0, 0, 0, 0, 0, 0.02, -0.01, -0.01, -0.01, 0, 0, -0.02, 0, 0, 0, 0, -0.01, -0.01, -0.01, 0.01, 0, 0, 0.01, -0.02, -0.02, -0.01, -0.02, -0.02, -0.02, -0.02, -0.01, 0, 0, -0.02, -0.02, 0, -0.01, -0.02, -0.02, -0.01, -0.01, 0.01, 0, 0, 0.01, 0.02, 0, 0, 0, -0.01, 0, 0, 0.01, 0.01, 0, 0, 0.01, 0.01, 0, 0.02, 0, -0.02, 0, 0, 0.02, 0, -0.03, 0.03, 0, -0.01, 0, -0.02, 0, -0.01, -0.01, 0.01, -0.02, -0.03, -0.02, 0, -0.02, -0.01, -0.01, 0, 0, -0.02, 0.01, 0, -0.02, 0, -0.02, 0, 0.02, 0, 0.01, 0, -0.02, 0, -0.02, 0.02, 0.01, 0.02, 0, 0, 0.02, 0, -0.02, 0.01, 0, -0.01, -0.02, 0, -0.01, 0.02, -0.01, 0, 0, 0, 0, -0.01, 0, -0.01, 0, -0.02, 0, 0, -0.01, -0.01, -0.02, 0, -0.02, 0, 0, -0.03, -0.02, 0, 0.02, -0.02, -0.02, 0, 0, -0.02, 0, -0.02, 0, 0.01, 0, 0, -0.02, -0.01, 0.01, 0, 0.02, 0, 0, 0.02, 0, 0.02, 0, 0.01, 0.01, 0.01, 0.02, 0, 0, 0.01, -0.01, 0, 0.02, -0.01, 0, 0.01, -0.01, -0.01, 0, 0, 0, 0, 0.02, -0.01, -0.03, 0, 0, 0, 0, 0, -0.02, -0.03, -0.04, -0.01, -0.04, -0.01, 0.01, -0.01, -0.01, 0, -0.02, 0, 0, 0, 0, 0.01, 0.02, 0, -0.01, 0, 0, 0, 0.01, 0.02, 0, 0.02, 0.01, 0, -0.01, 0.02, 0, 0, -0.01, 0, 0.01, 0.01, 0.01, -0.02, 0, 0, -0.01, 0, -0.01, 0, -0.01, 0.01, -0.04, -0.01, -0.03, -0.01, -0.01, 0, 0, 0.02, -0.02, -0.01, -0.02, -0.03, -0.02, -0.01, -0.01, 0, 0.01, -0.02, 0, -0.02, -0.02, 0, 0, -0.01, 0, 0.01, 0.02, 0.02, 0, 0.02, -0.01, 0.01, 0.01, 0.01, 0, 0, -0.01, 0.01, 0, 0, 0.01, 0.01, 0.02, 0, 0.01, 0, -0.02, -0.01, 0, 0.03, -0.03, 0, -0.02, -0.01, -0.03, 0.02, 0, -0.04, -0.02, -0.02, -0.03, -0.01, 0, -0.01, 0, -0.02, -0.01, -0.01, -0.02, -0.02, -0.02, 0, 0, 0.01, 0.01, 0.02, 0, 0, -0.01, 0, 0.02, -0.01, 0, 0.02, 0, 0, 0.02, 0, 0.01, 0.02, -0.01, -0.01, 0, -0.02, -0.04, -0.05, 0, 0, 0.01, 0, 0.01, -0.02, 0.01, -0.01, -0.01, 0.01, 0, 0, 0, -0.01, -0.02, 0, 0, -0.01, 0, 0, -0.01, -0.02, 0, -0.03, -0.02, -0.03, 0, -0.02, -0.03, -0.02, 0, -0.01, -0.01, 0, 0.02, 0, 0, 0, 0, 0.01, -0.01, 0, -0.01, 0.01, 0.02, 0, -0.01, -0.01, 0.01, 0.02, 0, -0.02, 0, -0.02, 0, 0, -0.03, -0.01, 0, 0, 0, -0.01, 0.02, -0.01, 0, 0, 0, 0, -0.02, 0, 0, 0, 0.02, -0.02, 0, 0, -0.02, -0.02, -0.01, 0.02
#latest bridge data test 21/05
#-0.012, 0, 0, 0, 0, -0.043, -0.039, 0, -0.012, -0.012, 0.037, 0, -0.019, -0.036, 0, 0.01, -0.012, -0.041, -0.039, -0.024, -0.029, -0.031, 0, -0.039, 0, 0.03, -0.043, -0.039, -0.017, -0.039, -0.039, -0.034, -0.019, -0.046, -0.029, -0.034, -0.024, -0.048, 0, -0.048, -0.048, -0.043, -0.048, -0.019, -0.017, -0.029, -0.029, 0, -0.017, -0.034, 0, -0.019, -0.039, -0.012, -0.039, 0, -0.029, -0.039, -0.039, -0.021, 0.022, 0, 0, 0.018, -0.014, -0.034, -0.029, -0.048, -0.034, -0.029, -0.036, -0.021, 0.022, -0.019, -0.043, -0.012, 0, 0.02, 0.032, -0.012, 0, 0, 0.015, 0.01, -0.039, 0, -0.019, -0.036, -0.019, -0.029, -0.043, -0.017, -0.039, 0.013, 0, -0.031, 0.015, -0.039, -0.031, -0.039, 0, -0.012, -0.017, -0.014, -0.048, 0, -0.039, 0.015, -0.041, -0.039, -0.034, -0.046, 0, 0, 0, -0.031, 0, -0.029, 0.027, -0.048, 0, -0.029, -0.029, 0.018, -0.019, -0.039, 0, -0.021, -0.029, -0.034, -0.029, 0.02, -0.021, 0.037, 0, -0.039, -0.024, -0.039, -0.014, -0.024, -0.034, 0, -0.034, 0.018, 0.015, -0.019, 0.022, 0, -0.034, -0.039, 0.015, 0.025, -0.034, -0.024, -0.031, -0.034, -0.048, -0.017, 0.022, -0.034, 0, -0.017, -0.031, 0.02, 0, -0.024, -0.024, -0.019, 0, 0, -0.014, 0.027, -0.019, -0.034, -0.039, -0.031, 0, -0.031, -0.048, -0.024, -0.048, 0.01, 0.01, 0, 0.047, -0.029, -0.021, -0.019, -0.019, -0.012, -0.026, -0.019, 0, 0, 0, 0.02, -0.046, 0.022, -0.048, -0.029, -0.012, 0, 0, -0.019, 0, 0, 0, 0.01, -0.012, -0.024, -0.019, 0, -0.029, 0.015, -0.034, 0, 0, 0, 0, -0.014, 0, -0.031, 0.027, -0.029, -0.046, 0, 0, -0.048, -0.014, -0.039, -0.021, -0.048, 0, 0.018, -0.029, -0.029, 0, 0.015, -0.029, -0.051, -0.048, -0.053, 0.015, 0, -0.024, -0.048, 0, 0.01, 0.013, -0.017, -0.031, 0, 0, -0.029, -0.014, -0.014, 0, -0.039, -0.048, -0.036, 0, -0.048, -0.017, 0.018, -0.029, 0, -0.031, 0.015, -0.034, -0.031, 0, -0.043, 0, 0, 0, 0.018, -0.039, -0.034, -0.039, 0, 0, -0.024, -0.014, 0.015, 0, -0.021, -0.034, -0.031, 0.02, 0, -0.029, 0.015, 0.032, 0.013, -0.021, 0, 0.018, -0.029, -0.014, 0, -0.029, -0.036, 0, 0.018, -0.029, -0.031, -0.012, 0.02, -0.019, 0.01, 0, -0.048, 0.018, -0.039, 0, -0.019, -0.012, -0.012, -0.019, -0.019, -0.048, 0, -0.014, 0, 0.027, 0, 0, 0, -0.029, 0, -0.012, 0, -0.039, 0.01, 0, -0.031, 0, 0, -0.043, 0, 0, 0, 0.03, -0.019, -0.026, 0, -0.017, -0.039, 0, 0, -0.014, -0.021, 0.015, 0.037, -0.041, -0.043, 0.018, 0.018, 0, 0, -0.041, 0, 0, -0.031, 0, -0.031, -0.024, -0.021, -0.034, 0, -0.039, 0, -0.048, 0, 0, 0, -0.021, -0.051, -0.031, 0, -0.031, -0.034, 0, -0.021, -0.012, -0.048, -0.029, -0.041, -0.053, 0, 0, 0, -0.036, -0.019, -0.048, 0.018, 0.013, 0, 0.018, -0.048, -0.017, -0.014, -0.034, 0, -0.036, -0.021, -0.039, 0, 0, 0, 0, 0.01, -0.046, -0.026, -0.034, -0.031, 0, -0.048, 0.013, 0, 0, -0.039, -0.048, 0, -0.019, -0.046, 0, -0.019, 0, -0.034, -0.019, -0.014, 0, 0, 0.018, -0.048, -0.021, -0.026, -0.048, -0.029, 0, -0.048, 0.018, -0.019, -0.031, -0.034, -0.019, -0.046, -0.029, -0.039, -0.017, -0.019, -0.026, 0, -0.048, 0.02, -0.051, -0.039, -0.012, 0, 0.02, -0.039, -0.017, -0.021, 0, 0, -0.031, -0.048, 0.018, -0.039, 0, 0, -0.041, -0.041, -0.024, -0.019, -0.029, 0, 0.015, -0.024, -0.034, 0, -0.031, 0, 0, 0, 0.015, -0.026, -0.034, 0, 0.025, -0.043, -0.029, -0.048, 0.015, 0.03, -0.021, -0.043, -0.014, -0.019, 0, -0.043, -0.031, 0, 0.02, -0.034, 0, -0.034, 0.022, -0.043, -0.039, 0, 0.01, -0.046, -0.048, 0.018, -0.029, 0, -0.014, -0.048, -0.039, 0, 0, -0.029, -0.039, -0.039, -0.034, 0, 0, -0.026, -0.029, -0.021, 0, -0.029, 0.018, 0, 0, -0.031, -0.021, -0.053, 0.018, -0.041, -0.039, -0.029, 0, -0.041, -0.029, 0, -0.048, 0, -0.041, -0.021, 0, -0.039, 0, -0.039, -0.012, 0.015, -0.031, -0.039, -0.034, 0, -0.039, 0.032, -0.026, 0, -0.039, 0, -0.034, -0.014, -0.043, 0, -0.029, 0, -0.043, -0.029, 0, -0.048, -0.017, 0, 0, -0.048, 0.015, -0.048, -0.029, -0.026, -0.034, -0.012, -0.024, 0.01, -0.031, 0, -0.048, -0.024, -0.019, 0.015, -0.029, -0.017, 0, -0.014, -0.012, -0.034, -0.039, 0, 0, -0.043, -0.039, 0, 0, 0, 0, -0.029, -0.021, 0.015, -0.024, 0, 0, -0.029, 0, 0, -0.019, 0, -0.029, -0.029, -0.036, -0.019, -0.031, 0, -0.029, 0, -0.019, 0.01, -0.043, 0, -0.019, -0.019, -0.034, 0, -0.012, 0, 0.01, 0, -0.031, -0.012, 0.01, 0, 0.02, -0.029, 0.01, -0.019, 0, -0.039, 0.02, 0, 0, -0.012, -0.048, 0, -0.034, -0.034, 0, 0, -0.034, -0.012, -0.019, -0.053, 0.027, -0.036, -0.048, 0, 0, 0, -0.034, -0.031, 0, -0.021, 0, -0.029, 0, -0.029, -0.012, 0, -0.024, 0.015, 0.035, 0, -0.034, -0.034, -0.039, 0, -0.039, -0.014, 0, 0, 0, 0, -0.031, 0, 0, -0.039, -0.048, 0, -0.036, 0.018, -0.019, -0.034, 0, -0.048, -0.031, -0.043, -0.034, 0, 0, 0, 0, -0.031, -0.034, -0.048, -0.021, -0.048, -0.048, 0, -0.024, -0.026, -0.034, -0.034, -0.048, -0.019, -0.031, -0.036, 0, 0.027, 0, 0.015, -0.026, -0.014, -0.048, -0.048, -0.039, -0.029, 0, -0.029, -0.017, 0, -0.039, 0, -0.043, -0.029, -0.043, -0.021, 0, -0.024, -0.019, 0.025, 0, 0, -0.029, -0.029, -0.026, -0.034, -0.034, -0.014, 0, -0.029, -0.019, -0.058, -0.019, -0.043, -0.039, -0.034, 0.015, 0, 0, 0, 0.013, -0.043, 0.01, -0.031, 0.018, -0.039, -0.031, -0.039, -0.014, -0.039, -0.019, -0.048, -0.031, -0.048, -0.021, -0.048, -0.048, -0.041, -0.039, -0.034, 0, -0.048, -0.017, -0.043, 0.032, 0, -0.036, -0.048, -0.034, -0.031, 0, -0.014, 0, 0, -0.019, 0, 0, -0.039, -0.024, 0, 0, 0, 0.015, 0, -0.043, 0, 0, -0.029, 0.022, -0.039, -0.034, -0.048, -0.034, 0.018, 0, -0.029, -0.053, -0.034, -0.017, 0.015, -0.043, -0.012, -0.029, 0, -0.039, -0.031, -0.039, -0.034, 0, 0.027, -0.039, 0, -0.012, -0.036, -0.019, -0.041, 0.032, 0.022, -0.041, -0.029, -0.048, 0, -0.048, -0.048, 0, 0, -0.029, -0.039, 0, -0.029, 0, 0, -0.048, -0.039, 0.015, 0, -0.014, 0, -0.019, -0.024, 0, 0, -0.048, 0, 0, -0.034, -0.012, 0.01, 0, 0, -0.012, -0.029, -0.048, -0.029, -0.012, -0.039, -0.034, -0.029, -0.043, -0.039, -0.019, 0, 0, -0.031, 0, 0, -0.031, -0.019, -0.012, -0.021, -0.034, 0.025, -0.043, 0, -0.039, -0.014, 0, 0, 0.025, -0.048, 0.027, -0.029, -0.024, -0.046, -0.048, 0, 0, -0.034, -0.048, -0.029, -0.048, -0.029, 0, -0.051, 0, 0, 0, -0.029, -0.029, 0, 0.018, 0, 0, -0.046, 0, -0.034, 0, -0.048, 0, -0.012, -0.039, -0.029, -0.029, -0.041, 0.013, -0.048, -0.019, -0.048, -0.048, -0.041, -0.034, 0.015, -0.021, -0.024, -0.014, -0.046, 0, -0.021, 0.037, 0.01, 0, -0.021, -0.041, -0.019, -0.029, -0.019, 0, -0.012, 0, -0.048, -0.034, 0, 0, -0.031, -0.043, -0.039, -0.031, 0, 0, 0.02, 0.015, -0.039, 0, -0.039, 0.015, 0, -0.039, -0.024, -0.048, -0.024, 0, 0.02, 0, -0.048, -0.031, -0.031, -0.031, -0.048, 0.018, -0.019, 0, -0.017, 0, 0, -0.039, -0.041, 0, 0, -0.048, 0.04, -0.039, 0, -0.031, 0, -0.031, -0.031, -0.019, 0, -0.021, -0.029, 
]


# Load acceleration samples 
excel_file = "node_1.xlsx"  # <- Replace with your actual file path
df = pd.read_excel(excel_file, engine='openpyxl')

accelerationSamples = df.iloc[:, 4].dropna().to_numpy()

#accelerationSamples = df["Acceleration"].dropna().to_numpy()


def computeFIRCoeffs(fs, beta=5):
    global firCoeffs
    fc1_norm = FC1 / (fs / 2.0)
    fc2_norm = FC2 / (fs / 2.0)
    sum_coeff = 0.0
    kaiser_window = np.kaiser(N, beta)
    for i in range(N):
        m = i - (N - 1) // 2
        if m == 0:
            coeff = fc2_norm - fc1_norm
        else:
            h1 = math.sin(math.pi * fc2_norm * m) / (math.pi * m)
            h2 = math.sin(math.pi * fc1_norm * m) / (math.pi * m)
            coeff = h1 - h2
        coeff *= kaiser_window[i]
        firCoeffs[i] = coeff
        sum_coeff += coeff
    for i in range(N):
        firCoeffs[i] /= sum_coeff

def butter_bandpass(lowcut, highcut, fs, order=4):
    return butter(order, [lowcut, highcut], fs=fs, btype='band', output='sos')

def apply_iir_filter(data, lowcut=FC1, highcut=FC2, fs=samplingFreq, order=4):
    sos = butter_bandpass(lowcut, highcut, fs, order)
    return sosfiltfilt(sos, data)

def applyFIRFilter(newSample):
    global firBuffer, sampleIndex
    firBuffer[sampleIndex] = newSample
    y = 0.0
    j = sampleIndex
    for i in range(N):
        y += firCoeffs[i] * firBuffer[j]
        j = (j - 1 + N) % N
    sampleIndex = (sampleIndex + 1) % N
    return y

def apply_hilbert_huang(signal, fs):
    # Empirical Mode Decomposition
    emd = EMD()
    imfs = emd.emd(signal)
    
    instantaneous_frequencies = []
    instantaneous_amplitudes = []
    instantaneous_phases = []
    # Apply Hilbert Transform to each IMF

    for imf in imfs:
        analytic_signal = hilbert(imf)
        amplitude_envelope = np.abs(analytic_signal)
        instantaneous_phase = np.unwrap(np.angle(analytic_signal))
        instantaneous_frequency = np.diff(instantaneous_phase) * fs / (2.0 * np.pi)

        instantaneous_amplitudes.append(amplitude_envelope[:-1])
        instantaneous_frequencies.append(instantaneous_frequency)
        instantaneous_phases.append(instantaneous_phase[:-1])  # match length

    return imfs, instantaneous_frequencies, instantaneous_amplitudes, instantaneous_phases

def apply_vmd_hilbert(signal, fs, alpha=2000, tau=0., K=3, DC=0, init=1, tol=1e-7):
    # Perform VMD
    u, u_hat, omega = VMD(signal, alpha, tau, K, DC, init, tol)

    instantaneous_frequencies = []
    instantaneous_amplitudes = []
    instantaneous_phases = []

    for imf in u:
        analytic_signal = hilbert(imf)
        amplitude_envelope = np.abs(analytic_signal)
        instantaneous_phase = np.unwrap(np.angle(analytic_signal))
        instantaneous_frequency = np.diff(instantaneous_phase) * fs / (2.0 * np.pi)

        instantaneous_amplitudes.append(amplitude_envelope[:-1])
        instantaneous_frequencies.append(instantaneous_frequency)
        instantaneous_phases.append(instantaneous_phase[:-1])

    return u, instantaneous_frequencies, instantaneous_amplitudes, instantaneous_phases

def main():
    i = 0
    while i != 2:

        computeFIRCoeffs(samplingFreq)
        iir_filtered = apply_iir_filter(accelerationSamples)
    
        raw_results = []
        filtered_results = []
    
        for sample in accelerationSamples:
            filteredAcc = applyFIRFilter(sample)
            raw_results.append(sample)
            filtered_results.append(filteredAcc)
            #time.sleep(1 / processRate)
    
        print("FIR processing complete.")
        
        emd = EMD()
        #imfs = emd.emd(iir_filtered)
    
        n = len(filtered_results)
        fft_data = fft(filtered_results)
        freqs = fftfreq(n, d=1/processRate)
        fft_filtered = np.copy(fft_data)
        fft_filtered[np.abs(freqs) > fft_cutoff_freq] = 0
        ifft_filtered = np.fft.ifft(fft_filtered)
    
        # Hilbert-Huang Transform 
        if i == 0:
            imfs, inst_freqs, inst_amps, inst_phases = apply_hilbert_huang(iir_filtered, processRate) #EMD
            
        if i == 1:
            imfs, inst_freqs, inst_amps, inst_phases = apply_vmd_hilbert(iir_filtered, processRate) #VMD
    
    
        signal_length = len(iir_filtered)
        time_axis = np.linspace(0, signal_length / processRate, num=signal_length)
        time_axis_inst = np.linspace(0, signal_length / processRate, num=signal_length-1)  
    
        fig, axs = plt.subplots(6, 1, figsize=(14, 18), sharex=False)
    
        # Time Domain Signals
        axs[0].plot(raw_results, label="Raw", linestyle='--', markersize=2)
        axs[0].plot(filtered_results, label="FIR Filtered", linewidth=2)
        axs[0].plot(iir_filtered, label="IIR Filtered", linestyle='--', linewidth=2)
        axs[0].plot(ifft_filtered.real, label="FFT Filtered", linestyle='-.', linewidth=2)
        axs[0].set_title("Time Domain Signals")
        axs[0].legend()
        axs[0].grid(True)
    
        # IMFs (Intrinsic Mode Functions)
        for idx, imf in enumerate(imfs):
            if len(imf) == len(time_axis):  
                axs[1].plot(time_axis, imf + idx*0.05, label=f"IMF {idx+1}")
        axs[1].set_title("Intrinsic Mode Functions (EMD)")
        axs[1].legend()
        axs[1].grid(True)
    
        # Instantaneous Frequencies
        for idx, freq in enumerate(inst_freqs):
            if len(freq) == len(time_axis) - 1:  
                axs[2].plot(time_axis_inst, freq, label=f"IMF {idx+1}")
        axs[2].set_ylim(0, 30)
        axs[2].set_ylabel("Frequency (Hz)")
        axs[2].set_title("Instantaneous Frequencies from Hilbert Transform")
        axs[2].legend()
        axs[2].grid(True)
    
        # Instantaneous Amplitudes
        for idx, amp in enumerate(inst_amps):
            if len(amp) == len(time_axis) - 1:
                axs[3].plot(time_axis_inst, amp, label=f"IMF {idx+1}")
        axs[3].set_ylabel("Amplitude")
        axs[3].set_title("Instantaneous Amplitudes from Hilbert Transform")
        axs[3].legend()
        axs[3].grid(True)
    
        # FFT
        axs[4].plot(freqs, np.abs(fft_filtered), label="FFT Magnitude")
        axs[4].set_xlim(0, 30)
        axs[4].set_xlabel("Frequency (Hz)")
        axs[4].set_title("Fourier Transform (after FIR)")
        axs[4].legend()
        axs[4].grid(True)
    
        # Instantaneous Phase
        for idx, phase in enumerate(inst_phases):
            if len(phase) == len(time_axis) - 1:
                axs[5].plot(time_axis_inst, phase, label=f"IMF {idx+1}")
        axs[5].set_ylabel("Phase (rad)")
        axs[5].set_title("Instantaneous Phase from Hilbert Transform")
        axs[5].legend()
        axs[5].grid(True)
    
        plt.tight_layout()
        plt.show()
    
        
        # Parameters
        n_time = len(time_axis_inst)
        n_freq_bins = 300  
        freq_min = 0.0
        freq_max = 15.0 
        
        # Prepare the bins
        freq_bins = np.linspace(freq_min, freq_max, n_freq_bins)
        time_bins = time_axis_inst
        
        # Create an empty amplitude grid
        hilbert_spectrum = np.zeros((n_freq_bins, n_time))
        
        # Fill the time-frequency-amplitude grid
        for imf_idx in range(len(inst_freqs)):
            for t_idx in range(n_time):
                freq = inst_freqs[imf_idx][t_idx]
                amp = inst_amps[imf_idx][t_idx]
                # Find frequency bin it belongs to
                if freq_min <= freq <= freq_max:
                    freq_bin_idx = np.searchsorted(freq_bins, freq) - 1
                    if 0 <= freq_bin_idx < n_freq_bins:
                        hilbert_spectrum[freq_bin_idx, t_idx] += amp
                        
                        
        # Plot the Hilbert Spectrum
        fig, ax = plt.subplots(figsize=(14, 6))
        extent = [time_bins[0], time_bins[-1], freq_bins[0], freq_bins[-1]]
        normalized_spectrum = hilbert_spectrum / np.max(hilbert_spectrum)
        im = ax.imshow(normalized_spectrum, extent=extent, aspect='auto', origin='lower', cmap='jet') #normalised
        epsilon = 1e-10  
        log_spectrum = np.log10(hilbert_spectrum + epsilon)
        im = ax.imshow(log_spectrum, extent=extent, aspect='auto', origin='lower', cmap='jet')  #logarithm
        #im = ax.imshow(hilbert_spectrum, extent=extent, aspect='auto', origin='lower', cmap='jet')
        ax.set_xlabel('Time (s)')
        ax.set_ylabel('Frequency (Hz)')
        if i == 0:
            ax.set_title('Hilbert Spectrum Using EMD (Time-Frequency-Amplitude)')
            
        else:
            ax.set_title('Hilbert Spectrum Using VMD (Time-Frequency-Amplitude)')
        fig.colorbar(im, ax=ax, label='Amplitude')
        plt.show()
        '''
        plt.figure(figsize=(10, 4))
        plt.plot(freqs, np.abs(fft_filtered), label="FFT Magnitude")
        plt.xlim(0, 30)
        plt.xlabel("Frequency (Hz)")
        plt.title("Fourier Transform (after FIR)")
        plt.legend()
        plt.grid(True)
        '''
        bin_width = 1.8           # Width of each frequency bin (Hz)
        start_freq = 1.6          # Start searching from 2 Hz
        end_freq = 7.0           # End frequency for peak search
        
        fft_magnitude = np.abs(fft_filtered)
        fft_positive_freqs = freqs[freqs >= 0]
        fft_positive_mags = fft_magnitude[freqs >= 0]
        
        peak_freqs = []
        peak_mags = []
        
        current_freq = start_freq
        while current_freq < end_freq:
            # bin range
            bin_start = current_freq
            bin_end = current_freq + bin_width
        
            # Get indices in current bin
            bin_indices = np.where((fft_positive_freqs >= bin_start) & (fft_positive_freqs < bin_end))[0]
        
            if len(bin_indices) > 0:
                # Find the local peak in this bin
                local_mags = fft_positive_mags[bin_indices]
                local_max_idx = np.argmax(local_mags)
                peak_freqs.append(fft_positive_freqs[bin_indices[local_max_idx]])
                peak_mags.append(local_mags[local_max_idx])
        
            current_freq += bin_width
        
        # Plot FFT with annotated peaks
        plt.figure(figsize=(10, 6))
        plt.plot(fft_positive_freqs, fft_positive_mags, label="FFT Magnitude")
        plt.plot(peak_freqs, peak_mags, "rx", label="Binned Peaks")
        for f, m in zip(peak_freqs, peak_mags):
            plt.annotate(f"{f:.2f} Hz", xy=(f, m), xytext=(f, m + 0.01), ha='center', fontsize=8, color='red')
        plt.xlim(0.2, 30)
        plt.xlabel("Frequency (Hz)")
        plt.ylabel("Magnitude")
        plt.title(f"FFT")
        plt.legend()
        plt.grid(True)
        plt.tight_layout()
        plt.show()
                
        i = i+1

if __name__ == "__main__":
    main()